\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{MQ_infinite_repeat}
  \pcomment{first part same as TP_infinite_repeat}
  \pcomment{second part extends TP_repeathalf}
  \pcomment{ARM 5/4/14}
  \pcomment{F15.final}
\end{pcomments}

\pkeywords{
  expectation
  conditional_expectation
  mean_time_to_failure
  infinite
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
You have a biased coin with nonzero probability $p<1$ of tossing a
Head.  You toss until a Head comes up.  Then\inbook{, similar to the
  example in Section~\bref{infinite_expect_sec},} you keep tossing
until you get another Head preceded by a run of consecutive Tails
whose length is within 10 of your original run.  That is, if you began
by tossing $k$ tails followed by a Head, then you continue tossing
until you get a run of at least $\max\set{k-10,0}$ consecutive Tails.

\bparts 

\ppart Let $H$ be the number of Heads that you toss until you get the
required run of Tails.  Prove that the expected value of $H$ is
infinite.

\begin{staffnotes}
\hint Conditional expectation conditioned on $k$.
\end{staffnotes}

\begin{solution}
Let the random variable $T$ be the length of your initial run of
tails.  Suppose $T$ takes the value $k$, that is, you flip $k$
consecutive Tails followed by a Head.  So your target number of Tails
is $m_k \eqdef \max\set{k-10,0}$.  Then you continue flipping until you
get $m_k$ Tails or another Head.  If you got a Head before getting $m_k$
consecutive Tails, then you try the same thing again.

The probability that trying to flip $m_k$ Tails after a Head will
succeed is $q^{m_k}$, where $q \eqdef 1-p$.  So thinking of flipping $m_k$
Tails as a ``failure,'' the expected number of Heads you flip will be
the mean time to failure, namely $1/q^{m_k}$.

So conditioning on the value of $T$, we have
\begin{align*}
\expect{H}
    & = \sum_{k \in \nngint} \expcond{H}{T=k} \cdot \prob{T=k}\\
    & = \sum_{k \in \nngint} \frac{1}{q^{m_k}} \cdot q^k p\\
    & = \text{constant} + \sum_{k \geq 10}  \frac{1}{q^{k-10}} \cdot q^k p\\
    & = \text{constant} + \sum_{k \geq 10} q^{10}p = \infty.
\end{align*}
\end{solution}

\ppart Let $r<1$ be a positive real number.  Instead of waiting for a
run of Tails of length $k-10$ when your original run was length $k$,
just wait for a run of length at least $rk$.  Show that in this case,
the expected number of Heads is finite.

\begin{solution}
Let $H_r$ be the expected number of heads under this earlier stopping rule.
Then
\begin{align*}
\expect{H_r}
    & = \sum_{k \in \nngint} \expcond{H_r}{T=k} \cdot \prob{T=k}\\
    & = \sum_{k \in \nngint} \frac{1}{q^{\ceil{rk}}} \cdot q^k p\\
    & \leq \sum_{k \in \nngint} \frac{1}{q^{rk+1}} \cdot q^k p\\
    & = \sum_{k \in \nngint} q^{k(1-r)} pq\\
    & = pq\sum_{k \in \nngint} \paren{q^{1-r}}^k\\
    & = \frac{pq}{1-q^{1-r}} < \infty.
\end{align*}
\end{solution}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
 
