\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{MQ_stirlings_asymptotics}
  \pcomment{from miniquiz-4-20}
  \pcomment{S15.ps9}
\end{pcomments}

\pkeywords{
   Stirlings
   Asymptotics
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{problem}

Show that 
\[
\ln (n^2!) = \Theta(n^2 \ln n)
\]

\hint Stirling's formula for $(n^2)!$.

\begin{solution} By Stirling's formula:
\[
(n^2)! \sim \stirling{n^2}\,.
%\sqrt{2 \pi n^2} \left(\frac{n^2}{e}\right)^{n^2}
\]
We can now take logarithms (see Problem~\bref{MQ_asymptotics_and_logs})
to get:

\begin{align*}
\ln(n^2!)
    & \sim \ln\paren{\sqrt{2 \pi n^2} \paren{\frac{n^2}{e}}^{n^2}} \\
    & = \ln(\sqrt{2 \pi n^2}) + \ln\paren{\paren{\frac{n^2}{e}}^{n^2}} \\
    & = \frac{1}{2}\ln 2\pi + \ln n + n^2 \ln\paren{\frac{n^2}{e}} \\
    & = \frac{1}{2}\ln 2\pi + \ln n + n^2(2 \ln n - 1)  & (\ln e = 1)
\end{align*}
It is then easy to see that this expression and $n^2 \ln n$ are
big-O of each other, so we conclude that $\ln (n^2!) = \Theta(n^2 \ln
n)$.
\end{solution}

\end{problem}

\endinput
