\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_conditional_expectation_even_throws}
  \pcomment{complements CP_conditional_even_throws}
  \pcomment{ARM 5/27/18}

\end{pcomments}

\pkeywords{
  conditional_probability
  dice
  independence
  conditional_expectation
  total_expectation
  geometric_series
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
A fair six-sided die is repeatedly thrown until a six appears.  We are
interested in the expected time for a six to appear under certain
conditions.

A natural probability space $\sspace$ modelling this situation is the
set of finite strings $s \in \strings{\Zintv{1}{5}}6$ of integers from
one to six that end at the first occurrence of a six, with
$\pr{s}\eqdef (1/6)^{\lnth{s}}$.  \iffalse For example, 256 is the
outcome corresponding to successively throwing two, five, six, with
$\pr{256} = (1/6)^3$.  The length-one string $6 \in \sspace$ is the
outcome corresponding to six appearing on the first throw.\fi Let $T$
be the random variable equal to the number of throws until six
appears, namely, $T(s)$ is the length $\lnth{s}$ of $s$.

\bparts

\ppart What is the expected time $\expect{T}$ till a six is thrown?

\begin{solution}
Thinking of throwing a six as ``failure,'' and applying the Mean Time
to Failure rule\inbook{ of
  Section~\bref{mean_time_to_failure_subsec}},
\[
\expect{T} = \frac{1}{\pr{6}} = \frac{1}{1/6} = 6.
\]
\end{solution}
\eparts

\medskip

Let $V$ be the event that all the dice throws are e\emph{V}en.  That is, $V =
\strings{\set{2,4}}6$ is the event that all throws are 2's and 4's
until the first 6.

\bparts

\ppart Prove that $\pr{V} = 1/4$.

\hint $V = 2V \union 4V \union \set{6}$.

\begin{solution}
Using the hint and the fact that $2V$, $4V$ and $\set{6}$ are
disjoint, we have
\begin{align*}
\pr{V}
  & = \pr{2V} + \pr{4V} + \pr{6}\\
  & = \pr{\text{first throw is 2}}\pr{V} +
      \pr{\text{first throw is 4}}\pr{V} + \frac16\\
  & = \frac16 \cdot \pr{V} + \frac16 \cdot \pr{V} + \frac16.
\end{align*}
Solving for $\pr{V}$ yields $\pr{V} = 1/4$.
\end{solution}

\ppart\label{ecTEsum} Use the definition of $\expcond{T}{V}$ as a sum
over $s \in V$ to compute the expected time $\expcond{T}{V}$ till a
six is thrown given that all throws are even.

\begin{solution}
We have
\begin{align*}
\expcond{T}{V}
  & \eqdef \sum_{s \in V} T(s)\prcond{s}{V}\\
  & = \sum_{s \in V} \lnth{s}\frac{\pr{s}}{\pr{V}}\\
  &  = \frac{1}{\pr{V}} \cdot \sum_{n=0}^\infty \sum_{s \in \set{2,4}^n6} (n+1)\paren{\frac16}^{n+1}\\
  &  = 4 \cdot\sum_{n=0}^\infty 2^n (n+1) \paren{\frac16}^{n+1}\\
  &  = 4 \cdot \frac{1}{2} \sum_{n=0}^\infty (n+1) \paren{\frac13}^{n+1}\\
  &  = 2 \cdot \frac{1/3}{\paren{1-(1/3)}^2}\\
  &  = 2 \cdot \frac34 = \frac32.
\end{align*}
\end{solution}

\ppart Given that all throws are even, the only possible throws are
two, four and six, so we might as well just consider a three-sided die
with sides two, four and six.  By Mean Time to Failure, the expected
time till a six is thrown by a three-sided die is 1/(1/3) = 3, so
\textcolor{red}{$\expcond{T}{V} = 3$}, contradicting 
part~\eqref{ecTEsum}!  Explain.\footnote{If you're
  thrown by this, you are not alone.  There are several
  \href{http://www.untrammeledmind.com/2017/12/counterintuitive-dice-probability-how-many-rolls-expected-to-get-a-6-given-only-even-outcomes}{websites}
  devoted to explanations of this seductive problem.  In fact, when it
  came up at the MIT Theory of Computation faculty lunch in April
  2018, several attendees confidently defended the mistaken
  reasoning.}

%\hint See Problem~\bref{CP_conditional_even_throws}.

\begin{solution}
Given that all throws are even, the only possible throws are two, four
and six, and we could try considering the expected time to a six of a
three-sided die, but \emph{not} a fair three-sided die.  To see what is going on, note that
if $s \in V$, then $s = t6$ for some $t\in \strings{\set{2,4}}$, and
\[
\prcond{s}{V} \eqdef \frac{\pr{s}}{\pr{V}} = \frac{(1/6)^{\lnth{s}}}{1/4} = \paren{\frac{1}{6}}^{\lnth{t}}\cdot \frac{1/6}{1/4} = \paren{\frac{1}{6}}^{\lnth{t}}\cdot \frac{2}{3}.
\]
So $\prcond{s}{V}$ is exactly the probability that $s$ is the sequence
of values thrown by a three-sided die with the probabilities $\pr{2} =
\pr{4} = 1/6$ and $\pr{6} = 2/3$.  (An alternative explanation of the
connection to throwing this biased three-sided die is given in
Problem~\bref{CP_conditional_even_throws}).  For this unfair
three-sided die, the mean time to a six is indeed 3/2, as in
part~\eqref{ecTEsum}.
\end{solution}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput

\iffalse
\ppart\label{V2V4V} 
It was shown in Problem~\bref{CP_conditional_even_throws} that
\begin{align*}
\prcond{\text{2 is thrown first}}{V} & = \frac16,\\
\prcond{\text{4 is thrown first}}{V} & = \frac16,\\
\prcond{6}{V} & = \frac23.
\end{align*}
Calculate $\expcond{T}{V}$ using these probabilities and Total
Expectation.  Confirm that your answer matches part~\eqref{ecTEsum}.

\begin{solution}
\begin{align*}
\expcond{T}{V}
 & = \expcond{T}{2V}\prcond{2V}{V} + \expcond{T}{4V}\prcond{4V}{V} + \expcond{T}{6}\prcond{6}{V}\\
 & = (1 + \expcond{T}{V})\pr{F_2} + (1 + \expcond{T}{V})\pr{F_4} + 1 \cdot \frac23\\
 & = (2 + 2\expcond{T}{V})\frac{1}{6} + \frac23.\\
 & = \frac{\expcond{T}{V}}{3} + 1,
\end{align*}
so
\[
\expcond{T}{V} = \frac{3}{2}.
\]
\end{solution}
\fi
