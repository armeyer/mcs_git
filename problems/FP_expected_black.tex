\documentclass[problem]{mcs}

\begin{pcomments}
\pcomment{FP_expected_black}
\pcomment{final.F05 final.S02 F98}
\pcomment{\textbf{Probability and Expectation}}
\end{pcomments}

\pkeywords{
  expectation
  harmonic
  probability
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
A box initially contains $n$ balls, all colored black.  A ball is
drawn from the box at random.
\begin{itemize}

\item If the drawn ball is black, then a biased coin with probability,
$p>0$, of coming up heads is flipped.  If the coin comes up heads, a white
ball is put into the box; otherwise the black ball is returned to the box.

\item If the drawn ball is white, then it is returned to the box.
\end{itemize}
This process is repeated until the box contains $n$ white balls.

Let $D$ be the number of balls drawn until the process ends with the box
full of white balls.  Prove that $\expect{D} = nH_n/p$, where $H_n$ is the
$n$th Harmonic number.

\hint Let $D_i$ be the number of draws after the $i$th white ball 
until the draw when the $(i+1)$st white ball is put into the box.

\begin{solution}
Suppose that the box contains $k$ white balls.  The
probability that a black ball is drawn and replaced by a white ball is $p
\cdot (n-k)/n$.  Taking the placement of a white ball into the box as a
``failure,'' we know the mean time to failure is $1/(p(n-k)/n) =
n/p(n-k)$.  So $\expect{D_i}$, expected number of draws to introduce one
more white ball is $n/p(n-k)$.  By linearity of expectation, the expected
number of draws required to fill the box with white balls is:
\begin{align*}
\expect{D} & = \sum_{k=0}^{n-1} D_i\\
    & =        \sum_{k=0}^{n-1} \dfrac{n}{p(n-k)}\\
    & =    \dfrac{n}{p} \cdot \sum_{k=0}^{n-1} \dfrac{1}{n-k} \\
    & =    \dfrac{n}{p} \cdot \sum_{j=1}^n \dfrac{1}{j} & (j = n - k)\\
    & =    \dfrac{nH_n}{p}.
\end{align*}

\end{solution}

\end{problem}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
