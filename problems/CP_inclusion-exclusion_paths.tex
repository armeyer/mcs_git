\documentclass[problem]{mcs}

\begin{pcomments}
\pcomment{CP_inclusion-exclusion_paths}
\pcomment{renamed from CP_inclusion_exclusion_paths}
\pcomment{minor variation of PS_path_counting}
\pcomment{was part of from CP_more_counting}
\pcomment{from: S09.cp10m commented out; S07 cp10f? maybe use S08.10f instead?}
\pcomment{last part extended based on FP_more_counting.(c).(d) by ARM
  4/7/10}
\end{pcomments}

\pkeywords{
  counting
  inclusion_exclsuion
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
\bparts

We want to count step-by-step paths between points in the plane
with integer coordinates.  Only two kinds of step are allowed: a
right-step which increments the $x$ coordinate, and an up-step which
increments the $y$ coordinate.

\ppart How many paths are there from $(0, 0)$ to $(20, 30)$?

\begin{solution}
\[
\binom{50}{20}\,.
\]

There is a bijection from 50-bit sequences with 20 zeros and 30
ones.  The sequence $(b_1, \ldots, b_{30})$ maps to a path where the
$i$-th step is right if $b_i = 0$ and up if $b_i = 1$.  Therefore, the
number of paths is equal to $\binom{50}{20}$.
\end{solution}

\ppart\label{paths_through} How many paths are there from $(0, 0)$ to $(20, 30)$ that go
through the point $(10, 10)$?

\begin{solution}
\[
\binom{20}{10}\cdot \binom{30}{10}\,.
\]

There is a bijection between the paths from $(20,30)$ that go through
$(10,10)$ and set of pairs of paths consisting of path from $(0,0)$ to
$(10,10)$ and a path from $(10,10)$ to $(20,30)$.  So the number of
paths through $(10, 10)$ is the product of the sizes of these two sets
of paths.
\end{solution}

\ppart How many paths are there from $(0, 0)$ to $(20, 30)$ that do
  \emph{not} go through either of the points $(10, 10)$ and
  $(15,20)$?

\hint Let $P$ be the set of paths from $(0, 0)$ to $(20, 30)$, $N_1$ be the
paths in $P$ that go through $(10,10)$ and $N_2$ be the paths in $P$
that go through $(15,20)$.

\begin{solution}
\[
\binom{50}{20} -
\binom{20}{10} \cdot \binom{30}{10} - \binom{35}{15} \cdot \binom{15}{5}
+ \binom{20}{10} \cdot \binom{15}{5} \cdot \binom{15}{5}.
\]

$N_1 \intersect N_2$ is the set of paths from $(0, 0)$ to $(20, 30)$
that go through both $(10, 10)$ and $(15,20)$.  So $P - (N_1 \union
N_2)$ is the set of paths to be counted.  Now we have
\begin{align*}
\Card{P - (N_1 \union N_2)}
     & = \card{P} - \Card{N_1 \union N_2}\\
     & = \card{P} - \card{N_1} - \card{N_2} + \Card{N_1 \intersect N_2}
           & \text{by Inclusion-Exclusion}.
\end{align*}
Part~\ref{paths_through} shows how to calculate $\card{N_i}$.  Also,
there is a bijection between $N_1 \intersect N_2$ and the set of
triples consisting of a path $(0,0)$ to $(10,10)$, a path from
$(10,10)$ to $(15,20)$, and a path from $(15,20)$ to $(20,30)$.  So
the size of $N_1 \intersect N_2$ is the product of the sizes of these
three sets of paths.

\end{solution}

\eparts
\end{problem}

\endinput
