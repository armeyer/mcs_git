\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_cayley}
  \pcomment{Cayley's formula}
  \pcomment{draft from wikipedia, edited by ARM 9/20/14}
\end{pcomments}

\pkeywords{
  tree
  forest
  Cayley
  counting
  double_counting
}

\begin{problem}[Counting trees]

What is the number $T_n$ of different trees that can be formed from a
set of $n$ distinct vertices?\footnote{From
  \href{https://en.wikipedia.org/wiki/Double\_counting\_\%28proof\_technique\%29\#Counting\_trees}
       {Double counting, wikipedia, Aug. 30, 2014}.  See also
       \href{https://en.wikipedia.org/wiki/prufer\_sequence}{Pr\"ufer
         Sequences}}  Cayley's formula gives the answer 
\[
T_n = n^{n - 2}.
\]

One way to derive this appears in Problem~\bref{CP_numbered_trees}.
This and three additional derivations are given by Aigner \& Ziegler
(1998), who comment that ``the most beautiful of them all'' is a
counting argument due to Jim Pitman that we now describe.

Pitman's derivation counts in two different ways the number of
different sequences of edges that can be added to an empty graph on
$n$ vertices to form a rooted tree.  One way to form such a sequence
is to start with one of the $T_n$ possible unrooted trees, choose one
of its n vertices as root, and choose one of the $(n - 1)!$ possible
sequences in which to add its $n - 1$ edges.  Therefore, the total
number of sequences that can be formed in this way is
\[
T_n n(n - 1)! = T_n n!\, .
\]

Another way to count these edge sequences is to start with the empty
graph and build up a spanning forest of rooted trees by adding edges
in sequence.  When $n - k$ edges have been added, the graph with these
edges will be a spanning forest consisting of $k$ rooted trees.  To
add the next edge, we choose any vertex to be the root of a new tree.
Then we add an edge between this new root and the root of any one of
the $k - 1$ subtrees that did not include the chosen vertex.  So the
next edge can be chosen in $n(k - 1)$ ways to form a new spanning
forest consisting of $k-1$ rooted trees.

Therefore, if one multiplies together the number of choices
from the first step, the second step, etc., the total number of
choices is
\[
   \prod_{k=2}^{n} n(k-1) = n^{n-1} (n-1)! = n^{n-2} n!\, .
\]
Equating these two formulas for the number of edge sequences, we get
$T_n n! = n^{n-2}n!$, and cancelling $n!$ we arrive at Cayley's
formula
\[
    T_n = n^{n-2}.
\]


\iffalse
Aigner and Ziegler describe how the proof can be generalized to count
the number of spanning forests consisting of $k$ rooted trees, for any
$k$.
\fi 

Generalize Pitman's derivation to count the number of spanning forests
consisting of $k$ rooted trees on $n$ vertices.

\begin{solution}
\TBA{This problem has not been checked for doability}
\end{solution}

\end{problem}

\endinput
