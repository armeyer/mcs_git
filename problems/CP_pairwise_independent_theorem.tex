\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_pairwise_independent_theorem}
  \pcomment{from: S09.cp14t, F07.rec15t}
  \pcomment{revised 5/9/14}
\end{pcomments}

\pkeywords{
  pairwise_independent
  sampling
  variance
  law_of_large_numbers
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
	
The proof of the \idx{Pairwise Independent Sampling}
Theorem~\bref{th:pairwise-sampling} was given for a sequence $R_1,
R_2, \dots$ of pairwise independent random variables with the same
mean and variance.

The theorem generalizes straighforwardly to sequences of pairwise
independent random variables, possibly with \emph{different}
distributions, as long as all their variances are bounded by some
constant.

\begin{theorem*}[Generalized Pairwise Independent Sampling]
Let $X_1, X_2, \dots$ be a sequence of pairwise independent random
variables such that $\variance{X_i} \leq b$ for some $b\geq 0$ and all
$i\geq 1$.  Let
\begin{align*}
A_n & \eqdef \frac{X_1 + X_2 + \cdots + X_n}{n},\\
\mu_n & \eqdef \expect{A_n}.
\end{align*}
Then for every $\epsilon > 0$,
\begin{equation}\label{gpis}
%\pr{\abs{A_n - \mu_n} > \epsilon} \leq \frac{b}{\epsilon^2} \cdot \frac{1}{n}.
\pr{\abs{A_n - \mu_n} \ge \epsilon} \le \frac{b}{\epsilon^2} \cdot \frac{1}{n}.
\end{equation}
\end{theorem*}

\bparts
\ppart
Prove the Generalized Pairwise Independent Sampling Theorem.

\begin{solution}
Essentially identical to the proof of
Theorem~\bref{th:pairwise-sampling} in the text, except that $S_n/n$ 
gets replaced by $A_n$, the $x$ gets replaced by $\epsilon$, the constant $b$ replaces $\variance{G_i}$,
and the equality before the first occurrence of $b$ gets replaced by
an inequality ($\leq$).

\begin{staffnotes}
It is OK for students to refer to the proof in the text and simply
comment on where changes must be made.  It is also OK to have students write down the revised proof.
\end{staffnotes}

\begin{proof}
We first observe that
\begin{equation}\label{}
\Variance{A_n} \leq \frac{b}{n},\label{vanbn}
\end{equation}
because
\begin{align*}
\lefteqn{\Variance{A_n}}\\
 & =  \frac{1}{n^2} \Variance{\sum_{i=1}^n X_i}
     & \text{(def of $A_n$ \& Thm~\bref{var.const}: square constant)}\\
 & =  \frac{1}{n^2} \sum_{i=1}^n \variance{X_i}
        & \text{(pairwise independent additivity)}\\
 & \leq \frac{1}{n^2}\cdot nb
   & (\text{since } \variance{X_i} \leq b)\\
 & =  \frac{b}{n}.
\end{align*}

%This is enough to apply \idx{Chebyshev's Theorem} and conclude:
Now, apply \idx{Chebyshev's Theorem} and conclude:\begin{align*}
\Prob{\abs{A_n - \mu_n} \geq \epsilon}
    & \leq \frac{\Variance{A_n}}{\epsilon^2}.
         & \text{(Chebyshev's bound)}\\
    & \leq \frac{b/n}{\epsilon^2}
         & \text{(by~\eqref{vanbn})}\\
    & = \frac{b}{\epsilon^2} \cdot \frac{1}{n}\ .
\end{align*}

\end{proof}

\end{solution}

\ppart
Conclude that the following holds:
\begin{corollary*}[Generalized \idx{Weak Law of Large Numbers}]
For every $\epsilon > 0$,
\[
\lim_{n \rightarrow \infty}
        \pr{\abs{A_n - \mu_n}  \leq \epsilon} = 1.
\]
\end{corollary*}

\begin{solution}
\begin{align*}
\pr{\abs{A_n - \mu_n}  \leq \epsilon}
  & =  1 - \pr{\abs{A_n - \mu_n}  > \epsilon}\\
  & \geq 1 - \frac{b}{\epsilon^2} \cdot \frac{1}{n},
    & \text{(by~\eqref{gpis})}
\end{align*}
and for any fixed $\epsilon$, this last bound approaches 1 as $n$
approaches infinity.
\end{solution}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\endinput
