\documentclass[problem]{mcs}

\begin{pcomments}
\pcomment{PS_min_weight_matrix}
\pcomment{Delerme from mcs digraph editing notes 3/17/16}
\end{pcomments}

\pkeywords{
  path
  walk
  weight
  matrix
  min-plus
}

\begin{problem}
  The \emph{weight of a walk} in a weighted graph is the sum of the weights of
  the successive edges in the walk.  The \emph{minimum weight matrix} for length
  $k$ walks in an $n$-vertex graph $G$ is the $n \times n$ matrix $W$ such that
  for $u,v \in \vertices{G}$,
  \[%\label{def:weight_matrix}
  W_{uv} \eqdef
  \begin{cases} w & \text{if $w$ is the minimum weight among length $k$
                              walks from $u$ to $v$},\\
                \infty & \text{if there is no length $k$ walk from $u$ to $v$}.
  \end{cases}
  \]
  The $\minplus$ product of two $n\times n$ matrices $W$ and $M$ with
  entries in $\reals\union \set{\infty}$ is the $n \times n$ matrix
  $W\minplusop M$ whose $ij$ entry is
  \[
  (W\minplusop V )_{ij} \eqdef \min \set{W_{ik} + V_{kj} \suchthat 1 \leq k \leq n}\, .
  \]
  Prove the following theorem.

\begin{theorem*}%\label{thm:weightmatrix-min+}
  If $W$ is the minimum weight matrix for length $k$ walks in a weighted
  graph $G$, and $V$ is the minimum weight matrix for length $m$ walks,
  then $W\minplusop V$ is the minimum weight matrix for length $k+m$
  walks.
\end{theorem*}

\begin{solution}
\begin{proof}
  Any length $k+m$ path between vertices $u$ and $v$ begins with a length
  $k$ path starting at $u$ and ending at some vertex $x$ followed by a
  length $m$ path starting at $x$ and ending at $v$.  So the minimum
  weight of a length $k+m$ path from $u$ to $v$ that goes through $x$ at
  the $k$th step equals the minimum weight $W_{ux}$ of length $k$ walks
  from $u$ to $x$, plus the minimum weight $V_{xv}$ of length $m$ walks
  from $w$ to $v$.  So we can get the minimum weight of length $k+m$ walks
  from $u$ to $v$ by taking the minimum over all possible vertices $x$ of
  the minimum weight of such walks that go through $w$ at the $k$th step.
  In other words,
\begin{equation}%\label{ln-min+nuv}
\text{min weight of a length $n+m$ path from $u$ to $v$} =
              \min_{x \in \vertices{G}} W_{ux}+V_{xv}\, .\tag{min+}
\end{equation}
But the right-hand side of~(min+) is precisely the definition of
$(W\minplusop V)_{uv}$.  Thus, $W\minplusop V$ is indeed the minimum weight
matrix for walks of length $k+m$.
\end{proof}
\end{solution}

\end{problem}

\endinput
