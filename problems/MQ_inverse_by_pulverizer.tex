\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{MQ_inverse_by_pulverizer}
  \pcomment{reformat of CP_inverse_by_pulverizer}
  \pcomment{from: S09.mqapr9, F07.mq4}
\end{pcomments}

\pkeywords{
  number_theory
  Pulverizer
  modular_arithmetic
  inverses
  Fermat_theorem
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
\bparts
\ppart\label{Pul40&7}
Use the Pulverizer to find integers $s, t$ such that
\[
40 s + 7 t = \gcd(40, 7).
\]
\inhandout{Show your work.  You will be graded on the correctness of
  the method; if you obtain the correct answer without implementing
  the Pulverizer, you will receive only partial credit.}

\examspace[4in]
\begin{solution}
$s=3$ and $t=-17$

Let $a=40, b=7$.  Here is the table produced by the Pulverizer:
 \[
 \begin{array}{ccccrcl}
 x & \quad & y & \quad & \rem{x}{y} & = & x - q \cdot y \\ \hline
  40 &&   7 &&  5 & = &    a - 5 \cdot  b \\
   7 &&   5 &&  2 & = &    b - 5 \\
 &&&&             & = &    b - (a - 5 \cdot  b) \\
 &&&&             & = &   -1 \cdot a + 6 \cdot b \\
   5 &&   2 &&  1 & = &   5  - 2 \cdot 2  \\
 &&&&             & = &   (a - 5 \cdot  b)
                          -2 \cdot (-1 \cdot a + 6 \cdot b) \\
 &&&&             & = &   3\cdot a -17 \cdot b \\
   2 &&   1 &&  0 &   &
 \end{array}
 \]
\end{solution}

\ppart Adjust your answer to part~\eqref{Pul40&7} to find an inverse
modulo 40 of 7 in $\Zintvco{1}{40}$.

\examspace[2in]

\begin{solution}
Since $1 = 3 \cdot 40 - 17 \cdot 7$, we have
\[
1 = -17 \cdot 7 \pmod{40}
\]
so $-17$ is an inverse of 7 modulo 40.  Therefore, so is
$\rem{-17}{40} = 23$.

\iffalse
 \begin{align*}
  1  & = 3 \cdot a - 17 \cdot b\\
     & = 3 \cdot a - b \cdot a + a \cdot b - 17 \cdot b\\
     & = (3-b) \cdot a + (a-17) \cdot b\\
     & = -4 \cdot a + 23 \cdot b
 \end{align*}
 Therefore, $23 \cdot b \equiv 1 \pmod{a}$ and 23 is the inverse
 of b modulo a.
\fi

\end{solution}

\eparts
\end{problem}
