\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{from: S09.ps8}
  \pcomment{from: S05.ps4}
  \pcomment{commented out in S09 - compare this problem to the CP version and also to the version adapted for use in a pset in F08}
\end{pcomments}

\pkeywords{
  number_theory
  RSA
  modular_arithmetic
  primes
  prime_factorization
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Reviewing the analysis of RSA may help you solve the following
problems.  You may assume results proved in class.

\bparts

\ppart Let $n$ be a nonnegative integer.  Prove that $n$ and $n^5$
have the same last digit.  For example:
%
\[
\underline{2}^5 = 3\underline{2}
\hspace{1in}
7\underline{9}^5 = 307705639\underline{9}
\]

\begin{solution}
The correctness of RSA relies on the following fact: if $p$
and $q$ are distinct primes, then
%
\[
m^{1 + k (p - 1)(q - 1)} \equiv m \pmod{pq}
\]
%
for all $m$ and $k$.  Setting $k = 1$, $p = 5$, and $q = 2$ proves the
claim.
\end{solution}

\ppart Suppose that $p_1, \ldots, p_k$ are distinct primes.  Prove
that
%
\[
m^{1 + (p_1 - 1)(p_2 - 1) \cdots (p_k - 1)} \equiv m \pmod{p_1 p_2
\cdots p_k}
\]
%
for all $m$ and all $k \geq 1$.

\begin{solution}
If $m$ is a multiple of a prime $p_j$, then
%
\begin{equation}
m^{1 + (p_1 - 1)(p_2 - 1) \cdots (p_k - 1)} \equiv m \pmod{p_j} \tag{*} \label{e
q:star}
\end{equation}
%
holds, because both sides are congruent to 0.  If $m$ is not a
multiple of $p_j$, then congruence~\eqref{eq:star} still holds
because:
%
\begin{align*}
m^{1 + (p_1 - 1)(p_2 - 1) \cdots (p_k - 1)}
    & \equiv m \cdot (m^{p_j - 1})^{(p_1 - 1)(p_2 - 1) \cdots (p_k - 1) / (p_j -
 1)} \pmod{p_j} \\
    & \equiv m \cdot 1^{(p_1 - 1)(p_2 - 1) \cdots (p_k - 1) / (p_j - 1)} \pmod{p
_j} \\
    & \equiv m \pmod{p_j}
\end{align*}
%
The second step uses Fermat's Theorem.  Now the
congruence~\eqref{eq:star} means that:
%
\[
p_j \mid m^{1 + (p_1 - 1)(p_2 - 1) \cdots (p_k - 1)} - m
\]
%
Thus, $p_j$ appears in the prime factorization of right side.  Since
this argument is valid for every prime $p_j$ where $1 \leq j \leq k$,
all of the primes $p_1, \ldots, p_k$ appear in the prime factorization
of:
%
\[
m^{1 + (p_1 - 1)(p_2 - 1) \cdots (p_k - 1)} - m
\]
%
Therefore:
%
\[
p_1 p_2 \cdots p_k \mid m^{1 + (p_1 - 1)(p_2 - 1) \cdots (p_k - 1)} - m
\]
%
Rewriting this as a congruence gives:
%
\[
m^{1 + (p_1 - 1)(p_2 - 1) \cdots (p_k - 1)} \equiv m \pmod{p_1 p_2
\cdots p_k}
\]

\end{solution}

\eparts
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
