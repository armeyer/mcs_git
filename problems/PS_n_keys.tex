 \documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_n_keys}
  \pcomment{subsume CP_expected_number_of_keys}
  \pcomment{clearer proof in CP_expected_number_of_keys}
  \pcomment{from: F07.ps11}
  \pcomment{edited 5/9/2014}
\end{pcomments}

\pkeywords{
  probability
  random_variable
  indicator_variable
  expectation
  variance
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
A man has a set of $n$ keys, only one of which will fit the lock on
the door to his apartment.  He tries the keys until he finds the right
one.  Give the expectation and variance of the number of keys he has
to try, when\dots

\bparts

\ppart \dots he tries the keys at random (possibly repeating a key tried
earlier).

\begin{solution}
This is a mean time to failure problem if finding the right key is taken to be
a ``failure''.  The probability $p$ of failure on the $i$th try,
given ``success'' on the previous tries, is $1/n$, so if $T$ is the
number of tries to find the right key, then $\expect{T} = 1/(1/n) =n$.

By Lemma~\bref{lem:var_time_to_fail},
\[
\variance{T} = \frac{1-p}{p^2} = n(n-1){.}
\]
\end{solution}

\ppart \dots he chooses keys randomly among the ones that he has not yet tried.

\begin{solution}
$T=k$ means that the man picks the wrong key on the first trial, and he
picks the wrong key on the second trial, etc, and he picks the right key on
the $k$-th trial.  Let $K_i$ be the indicator random variable for the $i$th
trial, namely, $K_i=1$ if he picks the right key on the $i$th trial, and $0$
otherwise.  Then,
\[
\pr{T=k} = \pr{K_1=0\ \&\ K_2=0\ \&\cdots\&\ K_{k-1}=0\ \&\ K_k=1}.
\]
By the Conditional Probability Product Rule, we can compute
\begin{align*}
\pr{T=k}
= & \pr{K_1=0} \prcond{K_2=0}{K_1=0} \prcond{K_3=0}{K_1=0\ \&\ K_2=0} \cdots\\
  & \qquad \cdots \prcond{K_k=1}{K_1=0\ \&\cdots\&\ K_{k-1}=0}\\
= & \frac{n-1}{n}\ \frac{n-2 }{n-1}\
\frac{n-3 }{n-2}\ \cdots\ \frac{n-k+1}{n-k+2}\ \frac{1}{n-k+1}\\
= & \frac{1}{n}.
\end{align*}
The expectation and variance are now easy to compute from the
definitions.
\[
\expect{T} = \sum_{k=1}^n k \cdot \pr{T=k}
 = \frac{1}{n}\sum_{k=1}^n{k} = \frac{n+1}{2}.
\]
\begin{align*}
\variance{T}
    &= \expect{T^2} - \expectsq{T}\\
    &= \sum_{k=1}^n{k^2 \pr{T=k}} - \paren{\frac{n+1}{2}}^2\\
    &= \frac{1}{n}\sum_{k=1}^n{k^2} - \paren{\frac{n+1}{2}}^2\\
    &= \frac{1}{n}\ \frac{n(n+1)(2n+1)}{6} - \paren{\frac{n+1}{2}}^2
          & \text{(sum of squares formula from equation~(\bref{eqn:G27}))}\\
    &= \frac{n^2-1}{12}.
\end{align*}
\end{solution}
\eparts
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput

\iffalse
Alternatively, the variance can be computed directly from the
formula,
\[
\variance{T} = \expect{T^2} - \expectsq{T},
\]
using the fact that $\pr{T=k} = pq^{k-1}$.  By definition we have
\[
\expect{T^2} = \sum_{k \in \nngint} k^2 pq^{k-1}
\]

To evaluate this sum, we use the following trick.  We know
that
\[
\sum_{k=1}^\infty{kq^k} = q\sum_{k=1}^\infty{kq^{k-1}} =
\frac{q}{(1-q)^2}
\]
Moreover,
\begin{align*}
\sum_{k=1}^\infty{k^2 q^{k-1}}
    &= \sum_{k=1}^\infty{\frac{d}{dq}k q^k}\\
    &= \frac{d}{dq}\sum_{k=1}^\infty{k q^k}\\
    &= \frac{d}{dq}\frac{q}{(1-q)^2}\\
    &= \frac{1}{(1-q)^2} + \frac{2q}{(1-q)^3} = \frac{1}{p^2} +
        \frac{2q}{p^3}{.}
\end{align*}

Finally, the expectation $\expect{T^2}$ is
\[
\expect{T^2} = p \left(\frac{1}{p^2} + \frac{2q}{p^3}\right)
     = \frac{1}{p} + \frac{2q}{p^2} {,}
\]
and the variance is
\[
\variance{T} = \frac{1}{p} + \frac{2q}{p^2} - \frac{1}{p^2} =
  \frac{q}{p^2} = n(n-1){.}
\]
\fi
