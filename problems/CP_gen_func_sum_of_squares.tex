\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_gen_func_sum_of_squares}
  \pcomment{old name: CP_sum_of_squares_2}
  \pcomment{from: S09.cp12m; S06 cp11m; revised from S04 cp13w}
\end{pcomments}

\pkeywords{
  generating functions
  counting
  convolution
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}\label{1xk}

\bparts

\ppart Let
\[
S(x) \eqdef \frac{x^2+ x}{(1-x)^3}.
\]
What is the coefficient of $x^n$ in the generating function series for
$S(x)$?

\iffalse
\hint A formula for the coefficient of $x^n$ in $1/(1-x)^k$ follows from
the Convolution Counting Principle and is given in the Appendix (and in
part~\eqref{tay} below).
\fi

\begin{solution}
$n^2$.  That is, $S(x) = \sum_{n=1}^{\infty} n^2x^n$.

To see why, note that the coefficient of $x^n$ in $1/(1-x)^3$ is, by the
Convolution Rule, the number of ways to select $n$ items of three
different kinds, namely,
\[
\binom{n+2}{2} = \frac{(n+2)(n+1)}{2}.
\]

Now the coefficient of $x^n$ in $x^2/(1-x)^3$ is the same as the
coefficient of $x^{n-2}$ in $1/(1-x)^3$, namely, $((n-2)+2)((n-2)+1)/2 =
n(n-1)/2$.  Similarly, the coefficient of $x^n$ in $x/(1-x)^3$ is the same
as the coefficient of $x^{n-1}$ in $1/(1-x)^3$, namely,
$((n-1)+2)((n-1)+1)/2 = (n+1)n/2$.  The coefficient of $x^n$ in $S(x)$ is
the sum of these two coefficients, namely,
\[
\frac{n(n-1)}{2} +\frac{(n+1)n}{2} = \frac{(n^2-n) + (n^2+n)}{2} = n^2.
\]
\end{solution}

\ppart Explain why $S(x)/(1-x)$ is the generating function for the sums of
squares.  That is, the coefficient of $x^n$ in the series for $S(x)/(1-x)$
is $\sum_{k=1}^n k^2$.

\begin{solution}
\begin{equation}\label{cp11w.ss}
\paren{\sum_{n=0}^{\infty} a_n x^n}\paren{\sum_{n=0}^{\infty} x^n}
= \sum_{n=0}^{\infty} \paren{\sum_{k=0}^{n} a_k\cdot 1} x^n =
\sum_{n=0}^{\infty} \paren{\sum_{k=0}^{n} a_k} x^n
\end{equation}
by the convolution formula for the product of series.  For $S(x)$, the
coefficient of $x^k$ is $a_k = k^2$, and
\[
S(x)/(1-x) = S(x)\paren{\sum_{n=0}^{\infty} x^n},
\]
so~\eqref{cp11w.ss} implies that the coefficient of $x^n$ in $S(x)/(1-x)$ is the
sum of the first $n$ squares.
\end{solution}

\ppart Use the previous parts to prove that
\[
\sum_{k=1}^n k^2 = \frac{n(n+1)(2n+1)}{6}.
\]

\begin{solution}
We have
\begin{equation}\label{S4}
\frac{S(x)}{1-x} = \frac{\paren{\frac{x(1+x)}{(1-x)^3}}}{1-x} = \frac{x+x^2}{(1-x)^4}.
\end{equation}
The coefficient of $x^n$ in the series expansion of
$1/(1-x)^4$ is
\[
\binom{n+3}{3}= \frac{(n+1)(n+2)(n+3)}{3!}.
\]
But by~\eqref{S4},
\[
\frac{S(x)}{1-x} = \frac{x}{(1-x)^4} + \frac{x^2}{(1-x)^4},
\]
so the coefficient of $x^n$ is the sum of the $(n-1)$st and $(n-2)$nd
coefficients of $(1-x)^4$, namely,
\[
\frac{n(n+1)(n+2)}{3!}+\frac{(n-1)n(n+1)}{3!}= \frac{n(n+1)(2n+1)}{6}.
\]
\end{solution}

\iffalse
\ppart (Optional)  How about a formula for the sum of cubes?

\begin{solution}TBA\end{solution}
\fi

\eparts

\end{problem}

\endinput
