\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{from: S09.cp8r}
%  \pcomment{}
%  \pcomment{}
\end{pcomments}

\pkeywords{
  number_theory
  modular_arithmetic
  primes
  RSA
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
  A critical question is whether decrypting an encrypted message always
  gives back the original message!  That is, whether $\rem{(m^{d})^e}{pq}
  =m$.  This will follow from something slightly more general:
\begin{lemma}\label{npdp}
Let $n$ be a product of distinct primes and $a \equiv 1 \pmod {\phi(n)}$
for some nonnegative integer, $a$.  Then
\begin{equation}\label{ma}
m^a \equiv m \pmod n.
\end{equation}
\end{lemma}

\bparts


\ppart Explain why Lemma~\ref{npdp} implies that $k$ and $k^5$ have the
same last digit.  For example:
%
\[
\underline{2}^5 = 3\underline{2}
\hspace{1in}
7\underline{9}^5 = 307705639\underline{9}
\]
\hint What is $\phi(10)$?

\solution{Two nonnegative integers have the same last digit iff they are
$\equiv \pmod {10}$.  Now $\phi(10) = \phi(2)\phi(5) = 4$ and $5 \equiv 1 \pmod 4$,
so by Lemma~\ref{npdp},
\[
k^5 \equiv k \pmod {10}.
\]}

\ppart Explain why Lemma~\ref{npdp} implies that the original message,
$m$, equals $\rem{(m^e)^d}{pq}$.

\solution{ To apply Lemma~\ref{npdp} to RSA, note that the first condition
  of the Lemma is that $n$ be a product of primes.  In RSA, $n=pq$ so this
  condition holds.

  For $n=pq$, the Euler function equations (see the
  Appendix) imply that $\phi(n) = (p-1)(q-1)$.  So when $d$ and $e$ are
  chosen according to RSA, $de \equiv 1 \pmod {\phi(n)}$.  So $a \eqdef
  de$ satisfies the second condition of the Lemma.

  Now, from equation~\eqref{ma} with $n=pq$ and $a=de$, we have
\[
(m^e)^d = m^{de} \equiv m \pmod {pq}.
\]
Hence,
\[
\rem{(m^e)^d}{pq} = \rem{m}{pq},
\]
but $\rem{m}{pq} = m$, since $0\leq m<pq$.}

\eparts

\bparts

\ppart\label{pma} Prove that if $p$ is prime, then
\begin{equation}\label{mp}
m^a \equiv m \pmod{p}
\end{equation}
for all nonnegative integers $a \equiv 1 \pmod {p-1}$.

\solution{
If $p \divides m$, then equation~\eqref{mp} holds since both sides of the
congruence are $\equiv 0 \pmod p$.

So assume $p$ does not divide $m$.  Now if $a \equiv 1 \pmod {p-1}$,
then $a = 1 + (p-1)k$ for some $k$, so
\begin{align*}
m^a & = m^{1+ (p-1)k}\\
    & = m\cdot \paren{m^{p-1}}^k\\
    & \equiv m\cdot \paren{1}^k \pmod p
            & \text{(by Fermat's Little Thm.)}\\
    & \equiv m \pmod p.
\end{align*}}

\iffalse

\ppart\label{abk} Show that for any positive integers $j,k$,
if $a \equiv b \pmod k$ and $j \divides k$, then $a \equiv b \pmod j$

\solution{
$a \equiv b \pmod k$ iff $k \divides (a-b)$.  But if $k \divides (a-b)$
and $j \divides k$, then also $j \divides (a-b)$, which implies $a \equiv
b \pmod j$.
}
\fi

\ppart\label{abp}
Prove that if $n$ is a product of distinct primes, and $a \equiv b
\pmod p$ for all prime factors, $p$, of $n$, then $a \equiv b
\pmod n$.

\solution{ By definition of congruence, $a \equiv b \pmod k$ iff $k
\divides (a-b)$.  So if $a \equiv b \pmod p$ for each prime factor, $p$,
of $n$, then $p \divides (a-b)$ for each prime factor, $p$, and hence, so
does their product (by the Unique Factorization Theorem).  That is, $n
\divides (a-b)$, which means $a \equiv b \pmod n$.}

\iffalse

\ppart\label{phip} Verify that for any $n>1$ and any prime divisor, $p$,
of $n$,
\[
\phi(p) \divides \phi(n).
\]

\solution{Let $p$ be a prime factor of $n$ and factor $n$ as $m\cdot p^k$
where $p$ does not divide $m$.  By the Euler function equations,
$\phi(n)=\phi(m)\phi(p^k)$, so $\phi(p^k) \divides \phi(n)$.  But
$\phi(p) = (p-1)$ which divides $(p-1)p^{k-1} = \phi(p^k)$.}
\fi


\ppart Combine the previous parts to complete the proof of
Lemma~\ref{npdp}.  \solution{Suppose $n$ is a product of distinct primes,
  $p_1p_2\cdots p_k$.  Then from the formulas for the Euler function,
  $\phi$, we have
\[
\phi(n) = (p_1 -1)(p_2 -1)\cdots (p_k-1).
\]

Now suppose $a \equiv 1 \pmod {\phi(n)}$, that is, $a$ is 1 plus a
multiple of $\phi(n)$, so it is also 1 plus a multiple of $p_i-1$.  That
is,
\[
a \equiv 1 \pmod {p_i-1}.
\]
Hence, by part~\eqref{pma},
\[
m^a \equiv m \pmod{p_i}
\]
for all $m$.  Since this holds for all factors, $p_i$, of $n$, we conclude
from part~\eqref{abp} that
\[
m^a \equiv m \pmod{n},
\]
which proves Lemma~\ref{npdp}.}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
