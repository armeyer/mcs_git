\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_sixteen_ions}
  \pcomment{from: S09.cp14m}
  \pcomment{rephrased by DIG from CP_sixteen_desks, 11/19/17}
\end{pcomments}

\pkeywords{
  expectation
  linearity
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
A novice mad scientist is attempting to put ions together into a salt crystal.
The crystal has sixteen ion locations in a $4 \times 4$ arrangement as shown
below.
\begin{center}
\begin{picture}(300,160)
% \put(0,0){\dashbox(270,198){}} % bounding box
\multiput(0,  0)(72,0){4}{\framebox(40,25){}}
\multiput(0, 40)(72,0){4}{\framebox(40,25){}}
\multiput(0, 80)(72,0){4}{\framebox(40,25){}}
\multiput(0,120)(72,0){4}{\framebox(40,25){}}
\end{picture}
\end{center}
If there is a sodium ion in front, behind, to the left, or to the right of a
chloride ion, then the two \emph{bond}.  One ion may be in multiple bonded
pairs; for example, an ion in a corner of the crystal can bond with up to two
others, while an ion in the center can bond with as many as four others.
Suppose that the locations are occupied mutually independently by sodium and
chloride ions with equal probability.  What is the expected number of bonded
pairs?  \hint Linearity.

\begin{center}
\exambox{0.5in}{0.5in}{0.0in}
\end{center}


\begin{solution}
A natural first approach to this problem is to calculate the expected number of
bonds that each ion is involved in, add the expectations for each ion, and then
divide by two (since each bond involves two ions).  This approach works fine,
but it requires finding the expectations for three different kinds of ion
locations: corner, side, and middle.

A more elegant approach is to note that the expected number of bonds between
adjacent ions is 1/2, and the number of pairs of adjacent ions is 24---there are
12 pairs adjacent horizontally (3 in each of 4 rows) and likewise 12 pairs
adjacent vertically.  So by linearity of expectation, the expected number of
bonds is $(1/2)\cdot 24 = 12$.

To be more explicit about this application of linearity, let's arbitrarily
number the pairs of adjacent ions from 1 to 24 and let $B_i$ be an indicator
random variable for the event that ions in the $i$-th pair bond.  Adjacent ions
bond iff they are of different types, which happen with probability 1/2, so
$\pr{B_i = 1} = 1/2$.  The expectation of an indicator variable is the same as
the probability that it equals 1\inbook{(Lemma~\bref{expindic})}, so
\begin{equation}\label{fi=12}
\expect{B_i} = \frac{1}{2}.
\end{equation}
Now, if $B$ is the number of bonds, then $B =
\sum_{i=1}^{24} B_i$, so the expectation we want is
\begin{align*}
\expect{B}
        & = \Expect{\sum_{i=1}^{24} B_i}\\
	& = \sum_{i=1}^{24} \expect{B_i} 
			& \text{(linearity of $\expect{\cdot}$)}\\
	& = \sum_{i=1}^{24} \frac{1}{2} 
			& \text{(equation~\eqref{fi=12})}\\
        & = 24 \cdot \frac{1}{2} = 12.
\end{align*}

\end{solution}
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
