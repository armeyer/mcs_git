\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_RSA_TF_ver1_f15}
  \pcomment{parts of FP_RSA_TF}
  \pcomment{adapted TP_RSA_lost_private_key: one choice let out}
  \pcomment{proposed for Midterm 3, F15; ZDz 10/24/15}
\end{pcomments}

\pkeywords{
  RSA
  public key
  private key
  Euler's theorem
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}

%Indicate whether the following statements are \textbf{true} or
%\textbf{false}\inhandout{ by circling \textbf{T} or \textbf{F}}.  Provide a brief
%argument justifying your choice for each statement.

\bparts

%\ppart Let $n$ and $a$ be positive integers.  If $n$ and $a$ are
%relatively prime, then
%
%\hspace{0.4in} $a^{(\phi(n)^2)} \equiv 1 \pmod{n}$. \inhandout{\hfill \textbf{T}
%  \qquad \textbf{F}}
%
%\begin{solution}
%
%\textbf{True.}  Euler's Theorem states that if $n$ and $a$ are
%relatively prime, then $a^{\phi(n)} \equiv 1 \pmod{n}$.  Raising both
%sides to the $\phi(n)^{\text{th}}$ power, we get that
%\[
%a^{(\phi(n))^2} = \paren{a^{\phi(n)}}^{\phi(n)} \equiv 1^{\phi(n)} = 1 \pmod{n}.
%\]
%\end{solution}
%
%\examspace[1.0in]

%\ppart If $n$ is a product of two distinct primes, then $\phi(n)$ is
%even.  \inhandout{\hfill \textbf{T} \qquad \textbf{F}}
\ppart Prove that if $n$ is a product of two distinct primes, then $\phi(n)$
is even.

\begin{solution}
%\textbf{True}. 
Let $n = pq$ for primes $p,q$.  Then, $\phi(n) =
\phi(p)\phi(q) = (p-1)(q-1)$.  Since 2 is the only even prime, at
least one of $p$ and $q$ must be odd, so at least one of $p-1$ and
$q-1$ must be even.  Therefore, $(p-1)(q-1)$ must be even.
\end{solution}

\examspace[1.5in]

%\ppart Suppose $a, b, c, d$ are any four positive integers and $ac
%\equiv bc \pmod{d}$.  Then
%
%\hspace{0.4in} $a \equiv b \pmod{d}$.  \inhandout{\hfill \textbf{T} \qquad \textbf{F}}
\ppart Find a counterexample to this false claim.
Suppose $a, b, c, d$ are any four positive integers and $ac \equiv bc \pmod{d}$. 
Then $a \equiv b \pmod{d}$.

\begin{solution}
  %\textbf{False}.
  To cancel $c$, we require that $c$ is relatively
  prime to $d$.  A counter-example is $a=1, b=2, d=3$, and $c=6$.
\end{solution}

\examspace[1.5in]

% \ppart In the RSA Cryptosystem, if $n=pq$ then the private key $d$ and the public key
% $(e,n)$ are chosen to satisfy:
% $d \cdot e \equiv 1 \pmod{pq}$. \inhandout{\hfill \textbf{T} \qquad \textbf{F}}
% \begin{solution}
%   \textbf{False}. The values of $d$ and $e$ are chosen to satisfy:
% \[
% d \cdot e \equiv 1 \pmod{(p-1)(q-1)} .
% \]
% \end{solution}
% \examspace[0.6in]

Ben Bitdiddle decided to encrypt all his data using RSA.
Unfortunately, he lost his private key.  He has been looking for it
all night, and suddenly a genie emerges from his lamp.  He offers Ben
a quantum computer that can perform exactly one procedure on large
numbers $e,d,n$.

\ppart
Which of the following procedures should Ben choose to recover his data? Explain.

\begin{itemize}
%\begin{enumerate}[(a)]
\item  Find $\gcd(e, d)$.
\item  Find the prime factorization of $n$.
\item  Determine whether $n$ is prime.
\item  Find $\rem{e^d}{n}$.
\item  Find the inverse of $e$ modulo $n$ (the inverse of $e$ in $\Zmod{n})$.
%\item  Find the inverse of $e$ modulo $\phi(n)$.
%\end{enumerate}
\end{itemize}

\begin{solution}
\begin{itemize}
\item Find the prime factorization of $n$.
%\item Find the inverse of $e$ modulo $\phi(n)$.
\end{itemize}
When the RSA public key is $(e,n)$, we could find the secret key the
same way the receiver does: by calculating $\phi(n)$.  Then
the secret key is the inverse of $e$ modulo $\phi(n)$.

We already know ``fast'' procedures---with running time proportional
to a at most a little more than the square of the length of the
decimal representations of $e,d,n$---for all the other items.
\end{solution}

\examspace[2in]

\eparts

\end{problem}

\endinput
