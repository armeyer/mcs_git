\pcomment{CP_fermat_probable_prime}
\pcomment{what was I thinking about here?---ARM 3/24/13}

\newcommand{\coset}[1]}{[#1]}
\newcommand{\order}[1]}{\mopt{ord}(#1)}

All $\equiv$'s below are $\pmod n$.

Define $\order{k} \eqdef \min{i \in \Zintvco{1}{n} \suchthat k^i \equiv 1}$

lemma: $k$ relatively prime to $n$ iff $k$ has an order.

$k, k^2,k^3, \dots$ must repeat $\equiv$ after at most $n$ steps, so
must have $k^i \equiv k^{i+m}$ for some $m>0$.  Cancel $k^i$ to get
$k^m \equiv 1$.

Suppose $k^{n-1} \not\equiv 1 \pmod n$ for some $k \in \Zintvco{1}{n}$.

k, k^2,k^3, \dots.  So k^m=1.  Define \order{k}

If $m<n-1$, have
some $a \notin \set{k^i \suchthat i\in \Zintvco{1}{m}}$.  

For $a \in \Zintvco{1}{n}$, define

\[
\coset{a} \eqdef \set{k^ia \suchthat i \in \Zintvco{1}{n}}
\]
