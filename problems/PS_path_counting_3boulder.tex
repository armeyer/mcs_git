\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_path_counting_3boulder}
  \pcomment{S17 ps7}
  \pcomment{moderate variation of PS_path_counting}
\end{pcomments}

\pkeywords{
  Inclusion-exclusion
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
  How many paths are there from point $(0, 0)$ to $(50, 50)$ if each
  step along a path increments one coordinate and leaves the other
  unchanged, with impassable boulders sitting at points $(10, 11)$, 
  $(20,33)$ and $(40,29)$?  (You do not have to calculate the number 
  explicitly; your answer may be an expression involving binomial 
  coefficients.)

\hint Inclusion-Exclusion.

\begin{solution}
We use Inclusion-Exclusion.  The total number of paths is
$\binom{100}{50}$, but we must subtract off the obstructed paths.
There are $\binom{21}{10} \cdot \binom{79}{40}$ paths through the
first boulder, since there are $\binom{21}{10}$ paths from the start
to the first boulder and $\binom{79}{40}$ paths from the boulder to
the finish.  Similarly, there are $\binom{53}{20} \cdot
\binom{47}{30}$ paths through the second boulder, and $\binom{69}{40} \cdot
\binom{31}{10}$ paths through the third boulder. However, we must
subtract off paths going through the first and second boulders, and the first
and third boulders. Note that since the second and third boulders are incomparable,
we do not need to consider paths through the second and third boulders together.  The number of these
is the number of paths from the origin to the first boulder times the number
of paths from the first boulder to the second boulder times the number
of paths from the second boulder to the end, namely
\[
\binom{21}{10} \cdot \binom{32}{10} \cdot \binom{47}{30}.
\]
and for the first and third:
\[
\binom{21}{10} \cdot \binom{48}{30} \cdot \binom{31}{10}.
\]
Therefore, the total number of paths is: %
\[
\binom{100}{50} - \binom{21}{10} \cdot \binom{79}{40}
- \binom{53}{20} \cdot \binom{47}{30} - \binom{69}{40} \cdot \binom{31}{10}
+ \binom{21}{10} \cdot \binom{32}{10} \cdot \binom{47}{30}
+ \binom{21}{10} \cdot \binom{48}{30} \cdot \binom{31}{10}
\]

\end{solution}

\end{problem}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
