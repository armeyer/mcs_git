\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_string_inclusion_exclusion}
  \pcomment{same as FP_bijection_counting except for 1st part}
  \pcomment{from S07:final.p5 with minor syntax edits}
\end{pcomments}

\pkeywords{
  combinatorics
  counting
  bijection
  inclusion-exclusion
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
We want to count the number of length-$n$ binary strings in which the
substring \STR{011} occurs in various places.  For example, the
length-14 string
\[
\STR{0010\textbf{011}0\textbf{011}101},
\]
has \STR{011} in the 4th position and the 8th
position.  (Note that by convention, a length-$n$ string
starts with position zero and ends with position $n-1$.)
Assume $n \geq 7.$

\bparts

\ppart Let $r$ be the number of length-$n$ binary strings in which
\STR{011} occurs starting at the 4th position.  Write a formula for
$r$ in terms of $n$.

\begin{center}
\exambox{0.6in}{0.5in}{0in}
\end{center}

\examspace[0.5in]

\begin{solution}
\[
r = 2^{n-3}.
\]

This is the number of patterns of the remaining $n-3$ bits besides the
substring \STR{011} occupying positions 4--6.
\end{solution}

\ppart Let $A_i$ be the set of length-$n$ binary strings in which
\STR{011} occurs starting at the $i$th position.  ($A_i$ is empty for
$i > n-3$.)  \iffalse , for $0 \leq i < n-2$.  So $A_i$ is empty for
$i \geq n-2$.\fi For any $i \neq j$, the intersection $A_i \intersect A_j$
is either empty or of size $s$.  Write a formula for $s$ in terms of
$n$.

\begin{center}
\exambox{0.6in}{0.5in}{0in}
\end{center}

\examspace[0.5in]

\begin{solution}
\[
s = 2^{n-6}.
\]

To be nonempty, the copies of \STR{011} at $i$ and $j$ use up 6
positions, leaving $n-6$ positions that can contain any pattern of
bits.  So $\card{A_i \intersect A_j} = 2^{n-6}$.
\end{solution}

\ppart\label{emptyij} Let $t$ be the number of pairs $(i,j)$ such that
$A_i \intersect A_j$ is nonempty, where $0 \leq i < j$.
Write a binomial coefficient for $t$ in terms of $n$.

%Express $t$ as a binomial coefficient.

\begin{center}
\exambox{0.6in}{0.5in}{0in}
\end{center}

\begin{solution}
  \[
  t = \binom{n-4}{2}.
  \]
  This is the same as asking how many ways there are to place two
  copies of \STR{011} in a length $n$ binary sequence.  Since the
  copies can't overlap, this is the same as the number of sequences
  with $n-6$ \STR{1}'s and two \STR{0}'s, where the \STR{1}'s indicate
  positions not occupied by the two copies and the \STR{0}'s indicate
  where the copies are placed.  By the Bookkeeper Principle, this is
\[  
\binom{(n-6)+2}{2}.
\]
\end{solution}

\ppart How many length 9 binary strings are there that contain the
substring \STR{011}?  You should express your answer as an integer or
as a simple expression which may include the above constants $r$, $s$
and $t$ for $n=9$.

%part~\eqref{emptyij}.

\hint Inclusion-exclusion for $\Card{\lgunion_0^8 A_i}$.

\begin{center}
\exambox{6.0in}{0.8in}{0in}
\end{center}

\examspace[2in]

\begin{solution}
\begin{equation}\label{9Ai7}
  \Card{\lgunion_0^8 A_i} = 7 \cdot r - t \cdot s + 1 = 369.
\end{equation}

By Inclusion-exclusion
\begin{equation}\label{lgu19Ai}
  \Card{\lgunion_0^8 A_i} = \sum_0^8 \card{A_i} - \sum_{i \neq j} \card{A_i
    \intersect A_j} + \sum_{i \neq j \neq k} \card{A_i
    \intersect A_j \intersect A_k}.
\end{equation}

Since $A_7=A_8=\emptyset$, there are 7 terms in the first sum
in~\eqref{lgu19Ai}, and each term is $r$.

There are $t$ terms in the second sum in~\eqref{lgu19Ai}, each of size $s$.

Finally, among the terms in the third sum,
\[
A_0 \intersect A_3 \intersect A_6 = \set{\mathtt{011011011}},
\]
and all the other intersections are empty, so the third term is 1.
This leads to equation~\eqref{9Ai7}.

\end{solution}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
