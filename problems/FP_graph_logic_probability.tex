\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_graph_logic_probability}
  \pcomment{first parts of CP_graph_logic_probability_S16}
  \pcomment{ARM 5/10/16}
\end{pcomments}

\pkeywords{
  graph
  logic
  probability
  independence
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $G$ be a simple graph with $n$ vertices.  Let ``$A(u,v)$'' mean
that vertices $u$ and $v$ are adjacent, and let ``$W(u,v)$'' mean that
there is a length-two walk between $u$ and $v$.

\bparts

\ppart Explain why $W(u,u)$ holds iff $\exists v.\ A(u,v)$.

\examspace[0.8in]

\begin{solution}
A length two path from $u$ to $u$ must be a path that goes back and
forth on some edge incident to $u$.
\end{solution}

\ppart Write a predicate-logic formula defining $W(u,v)$ in terms of
the predicate $A(.,.)$ when $u \neq v$.

\examspace[0.6in]

\begin{solution}
\[
W(u,v) \eqdef \exists t.\, A(u,t) \QAND\ A(t,v).
\]

This formula actually works even if $u=v$.
\end{solution}

\eparts

There are $e \eqdef \binom{n}{2}$ possible edges between the $n$
vertices of $G$.  Suppose the actual edges of $\edges{G}$ are chosen
randomly from this set of $e$ possible edges.  Each edge is chosen
with probability $p$, and the choices are mutually independent.

\bparts

\ppart Write a simple formula in terms of $p, e$, and $k$ for
$\pr{\card{\edges{G}} = k}$.

\exambox{0.8in}{0.7in}{0in}

\examspace[0.3in]

\begin{solution}
\[
\binom{e}{k} p^k(1-p)^{e-k}.
\]

The number of chosen edges has a binomial distribution.
\end{solution}

\ppart Write a simple formula in terms of $p$ and $n$ for $\pr{W(u,u)}$.

\exambox{0.8in}{0.7in}{0in}

\examspace[0.3in]

\begin{solution}
\[
1- (1-p)^{n-1}.
\]

$\QNOT(W(u,u))$ iff none of the possible $n-1$ incident edges are
edges of $G$.  Since edges of $G$ are chosen independently and the
probability is $1-p$ that any given edge is in $\edges{G}$,
\[
\pr{\QNOT(W(u,u))} = (1-p)^{n-1}.
\]
\end{solution}

\eparts

Let $w$, $x$, $y$ and $z$ be four distinct vertices.

Because edges are chosen mutually independently, events
that depend on disjoint sets of edges will be mutually independent.
For example, the events
\[
A(w,y) \QAND A(y,x)
\]
and
\[
A(w,z) \QAND A(z,x)
\]
are independent since $\edge{w}{y}, \edge{y}{x}, \edge{w}{z},
\edge{z}{x}$ are four distinct edges.

%\examspace

\bparts

\ppart  Let
\begin{equation}\label{nottwopath}
r \eqdef \pr{\QNOT(W(w,x))},
\end{equation}
where $w$ and $x$ are distinct vertices.  Write a simple formula for
$r$ in terms of $n$ and $p$.

\hint Different length-two paths between $x$ and $y$ don't share any
edges.

\exambox{1.5in}{0.7in}{0in}

\examspace[0.5in]

\begin{solution}
\[
r = (1-p^2)^{n-2}.
\]

Let $Z \eqdef \vertices{G} - \set{w,x}$ be the set of $n-2$ vertices
other than $w$ and $x$.
\begin{align*}
\lefteqn{\pr{\QNOT(W(w,x))}}\\
  & = \pr{\forall z \in Z.\, \QNOT(A(w,z) \QAND\ A(z,x))}\\
  & = \prod_{z \in Z} \pr{\QNOT(A(w,z) \QAND\ A(z,x))}
          & \text{(by the hint, the length-two paths are independent)}\\
  & = \prod_{z \in Z} (1 - \pr{A(w,z) \QAND\ A(z,x)})\\
  & = \prod_{z \in Z} (1-\pr{A(w,z)}\cdot \pr{A(z,x)})
          & \text{(edges are independent)}\\
  & = \prod_{z \in Z} (1-p^2) \\
  & = (1-p^2)^{n-2}.
\end{align*}
\end{solution}

\iffalse
\ppart \label{3cycle} Vertices $x$ and $y$ being on a three-cycle can
be expressed simply as
\[
A(x,y) \QAND\ W(x,y).
\]
Write a simple expression in terms of $p$ and $r$ for the probability
that $x$ and $y$ lie on a three-cycle in $G$.

\exambox{0.8in}{0.7in}{0in}

\examspace[0.5in]

\begin{solution}
\[
p(1-r).
\]

$A(x,y)$ and $W(x,y)$ are independent since $W(x,y)$ does not depend
on whether $\edge{x}{y}$ is an actual edge of $G$.  Therefore,
\begin{align*} 
\pr{A(x,y) \QAND\ W(x,y)}
   & = \pr{A(x,y)} \cdot \pr{W(x,y)} \\
   & = p (1-r) .
\end{align*}
\end{solution}

\ppart\label{Wwxyz} Are $W(w,x)$ and $W(y,z)$ independent events?
Briefly comment (proof not required).

\examspace[0.75in]

\begin{solution}
The more randomly chosen edges there are in $G$, the more likely
length two walks become.  Now $W(w,x)$ implies the existence of two
edges---which might be incident to $y$ or $z$---and this makes
$W(y,z)$ more likely given $W(w,x)$.
\begin{staffnotes}
\TBA{Derive formula for $\prcond{W(w,x)}{W(y,z)}$ and see that it
  differs from $r$.}
\end{staffnotes}
\end{solution}
\fi

\eparts
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput


Original Solution: In this counterexample,
\[
W(w,x) \equiv (A(w,y) \QAND{} A(y,x)) \QOR{} (A(w,z) \QAND{} A(z,x))
\]
and
\[
W(x,y) \equiv (A(x,w) \QAND{} A(w,y)) \QOR{} (A(x,z) \QAND{} A(z,y)).
\]

By symmetry, we apply inclusion-exclusion to calculate the probability
for either of these events:
\[
\paren{\frac{1}{2}}^2 + \paren{\frac{1}{2}}^2 - \paren{ \frac{1}{2}}^4 = \frac{7}{16}.
\]

Now consider $\prcond{W(w,x)}{W(x,y)}$, the fraction of outcomes
satisfying $W(x, y)$ that also satisfy $W(w, x)$.  Partition the
outcomes satisfying $W(x, y)$ by whether they also satisfy $A(w, y)$.
Both sides of the partition are independent of $A(y, x)$ in the sense
formalized above, since $A(y, x)$ doesn't appear in the definition of
$W(x, y)$.  That means that the outcomes in the subcase for $A(w, y)$
can be partitioned into equally sized sets, one with $A(y, x)$ and the
other with $\bar{A(y, x)}$.  Clearly every element of the first set
satisfies $W(w, x)$, so
\[
\prcond{W(w, x)}{W(x, y) \QAND{} A(y, x)} \geq \frac{1}{2}.
\]

--------------
  For
  $|V| = 4$ and $p = \frac{1}{2}$, we have
\[
W(w,x) \equiv (A(w,y) \QAND\ A(y,x)) \QOR\ (A(w,z) \QAND\ A(z,x))
\]
 and
\[
W(y,z) \equiv (A(y,x) \QAND\ A(x,z)) \QOR\ (A(y,w) \QAND\ A(w,z)).
\]

\[
\prcond{W(w, x)}{W(y, z) \QAND{} (A(y,x) \QAND{} A(x,z))} = \frac{3}{4},
\]
since under these conditions the formula for $W(w,x)$ simplifies to
$A(w,y) \QOR A(w,z)$.
\[
\prcond{W(w, x)}{W(y, z) \QAND\ \QNOT (A(y,x) \QAND\ A(x,z))} = \frac{1}{2}
\]
since under these conditions we know $A(y,w) \QAND\ A(w,z)$, and the
formula for $W(w,x)$ simplifies to 
\[
(A(y,x) \QOR\ A(z,x)) \QAND\ \QNOT(A(y,x) \QAND\ A(z,x)).
\]
Both sides of the partition have probabilities no less than
$\frac{1}{2}$, so $\prcond{W(w, x)}{W(y, z)} \geq \frac{1}{2}$, which
again is above $\pr{W(w, x)}$, which can be computed as $\frac{7}{16}$
as in the prior case.
-----------

The outcomes in the subcase for $\bar{A(w, y)}$ must all have $A(x,
z)$, so, like above partitioning them based on $A(w, z)$, we get two
equal-size sets, where the set with $A(w, z)$ all satisfy $W(w, x)$,
and
\[
\prcond{W(w, x)}{W(x, y) \QAND\ \bar{A(y, x)}} \geq \frac{1}{2}.
\]
The true value of $\prcond{W(w, x)}{W(x, y)}$ must lie somewhere
between these two values, so it also must be no less than
$\frac{1}{2}$, and thus it must be greater than $\pr{W(w, x)} =
\frac{7}{16}$.

\vspace{0.05in} Less complicated explanation: We want to show that
$\prcond{W(w,x)}{W(x,y)} \neq \Pr{W(w,x)}$.  If $W(x,y)$, this
increases the probability of $A(z,x)$ and $A(w,y)$, which can be used
for $W(w,x)$.

\fi



% Exam version commented out for use as a class problem.  \iffalse
\ppart \inbook{Indicate}\inhandout{Circle} the mathematical formula
that best expresses the definition of $W(x,y)$.

\begin{itemize}
\item $W(x,y) \eqdef \exists z.\ A(x,z) \QAND\ A(y,z)$
\examspace[0.15in]
\item $W(x,y) \eqdef x \neq y \QAND\ \exists z.\ A(x,z) \QAND\ A(y,z)$
\examspace[0.15in]
\item $W(x,y) \eqdef \forall z.\ A(x,z) \QOR\ A(y,z)$
\examspace[0.15in]
\item $W(x,y) \eqdef \forall z.\ x \neq y \QIMPLIES\ [A(x,z) \QOR\ A(y,z)]$
\end{itemize}
\fi
