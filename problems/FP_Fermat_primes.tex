\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_Fermat_primes}
  \pcomment{ARM 5/15/14}
\end{pcomments}

\pkeywords{
  number_theory
  modular_arithmetic
  Fermat_theorem
  Z_n
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
The \emph{order} of $k \in \Zmod{n}$ is the smallest positive $m$ such
that $k^m = 1 \inzmod{n}$.

\bparts

\ppart\label{km1zn} Prove that
\[
k^m = 1 \inzmod{n}\ \QIMPLIES\ \ordmod{k}{n} \divides m.
\]

\hint Take the remainder of $m$ divided by the order.

\examspace[2.5in]

\begin{solution}
Let $d$ be the order of $k$, and $q,r$ be the quotient and remainder
of $m$ divided by $d$, so
\[
m = qd + r
\]
where $r \in [0,k)$.  Now,
\begin{align*}
1 = k^m & = k^{qk+r} \inzmod{n}\\
        & = \paren{k^d}^q \cdot k^r\\
        & = 1^q \cdot k^r  \inzmod{n}\\
        & = k^r.
\end{align*}
But $r \in \Zintvco{0}{d}$, and since $d$ is the smallest positive power of $k$
  equal to 1 in $\Zmod{n}$, we must have $r = 0$, that is, $d \divides
  m$.
\end{solution}

\eparts

Now suppose $p>2$ is a prime of the form $2^s+1$.  For example,
$2^1+1,2^2+1,2^4+1$ are such primes.

\bparts

\ppart~\label{1<k<pordmod} Conclude from part~\eqref{km1zn} that if $0 <
k < p$, then $\ordmod{k}{p}$ is a power of 2.

%\examspace[1.5in]

\begin{solution}
$p-1$ is a power of two, and therefore so are all its factors.
But by Fermat's Little Theorem,
\[
k^{p-1} = 1 \inzmod{p},
\]
and we conclude from part~\eqref{km1zn} that $\ordmod{k}{p}$ is a factor
of $p-1$.
\end{solution}

\inbook{
\ppart Prove that $\ordmod{2}{p} = 2s$ and conclude that $s$ is a power
of 2.\footnote{Numbers of the form $2^{2^k}+1$ are called \emph{Fermat
    numbers}, so we can rephrase this conclusion as saying that
  any prime of the form $2^s+1$ must actually be a Fermat number.  The
  Fermat numbers are prime for $k=1,2,3,4$, but not for $k=5$.  In
  fact, it is not known if any Fermat number with $k > 4$ is prime.}

\hint $2^k - 1$ for $k \in \Zintvcc{1}{r}$ is positive but too small
to equal $0 \inzmod{p}$.  \iffalse Same for $-(2^j + 1)$ for $j \in
\Zintvco{1}{r}$, and
\[
p-(2^j + 1) = -2^j - 1 = 2^s(2^j) -1 = 2^{r+j} -1 \inzmod{p}.
\]\fi


\begin{solution}
Clearly $2^{2s} = 1 \inzmod{p}$, since $2^s = -1 \inzmod{p}$ by
definition of $p$.  So the order of 2 in $\Zmod{p}$ is at most $2s$.
To show it is not $< 2s$, observe from the hint that
\[
2^1-1,2^2-1,\dots, 2^s-1 \neq 0 \inzmod{p},
\]
so
\[
2^1,2^2,\dots, 2^s \neq 1 \inzmod{p}.
\]
Likewise
\begin{align*}
\lefteqn{2^{r+1}-1,2^{r+2}-1,\dots, 2^{2r-1}-1 }\\
&  = 2^r(2^1)-1,2^r(2^2)-1,\dots, 2^r(2^{r-1})-1\\
&  = -(2^1)-1, -(2^2)-1,\dots, -(2^{r-1})-1 \neq 0 \inzmod{p},
\end{align*}
and so
\[
2^{r+1}, 2^{r+2}, \dots, 2^{2r-1} \neq 1 \inzmod{p}.
\]
Therefore the order of 2 in $\Zmod{p}$ is not less than $2s$ and hence
equals $2s$.  We conclude from part~\ref{1<k<pordmod} that $2s$ is a
power of 2, which implies that $s$ is a power of 2.

There is another more elementary proof\footnote{Adapted from
  Wikipedia, \emph{Fermat number}, May 9, 2014.} (that does not follow
the hints).  If $n$ is odd, the polynomial $x^n + 1$ has $-1$ as a
root, and so $x^n + 1$ is divisible by $x + 1$.  Now suppose $s = mn$
and $n>1$ is odd.  Letting $x=2^m$, we have $2^s + 1 = \paren{2^m}^n
+1$ is divisible by the smaller number $2^m + 1$ and so is not prime.
But if $s>1$ is not a power of two, it must have an odd factor greater
than 1.  Therefore, if $2^s+1 > 2$ is prime, $s$ must be a power of
two.
\end{solution}
}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
