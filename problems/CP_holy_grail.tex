\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{from: S09.cp9m}
  \pcomment{has a commented out part}
\end{pcomments}

\pkeywords{
  harmonic_numbers
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
An explorer is trying to reach the Holy Grail, which she believes is
located in a desert shrine $d$ days walk from the nearest oasis.  In the
desert heat, the explorer must drink continuously.  She can carry at most
1 gallon of water, which is enough for 1 day.  However, she is free to
create water caches out in the desert.

For example, if the shrine were $2/3$ of a day's walk into the desert,
then she could recover the Holy Grail with the following strategy.
She leaves the oasis with 1 gallon of water, travels $1/3$ day into
the desert, caches $1/3$ gallon, and then walks back to the oasis---
arriving just as her water supply runs out.  Then she picks up another
gallon of water at the oasis, walks $1/3$ day into the desert, tops
off her water supply by taking the $1/3$ gallon in her cache, walks
the remaining $1/3$ day to the shine, grabs the Holy Grail, and then
walks for $2/3$ of a day back to the oasis--- again arriving with no
water to spare.

But what if the shrine were located farther away?

\bparts

\ppart What is the most distant point that the explorer can reach and then
return to the oasis if she takes only 1 gallon from the oasis?

\begin{solution}
At best she can walk $1/2$ day into the desert and then walk
  back.
\end{solution}

\ppart What is the most distant point the explorer can reach and still
return to the oasis if she takes only 2 gallons from the oasis?  No proof
is required; just do the best you can.

\begin{solution}
The explorer walks $1/4$ day into the desert, drops $1/2$
  gallon, then walks home.  Next, she walks $1/4$ day into the desert,
  picks up $1/4$ gallon from her cache, walks an additional $1/2$ day out
  and back, then picks up another $1/4$ gallon from her cache and walks
  home.  Thus, her maximum distance from the oasis is $3/4$ of a day's
  walk.
\end{solution}


\iffalse
\ppart What about 3 gallons?  \hint First, try to establish a cache of 2
gallons \textit{plus} enough water for the walk home as far into the
desert as possible.  Then use this cache as a springboard for your
solution to the previous part.

\begin{solution}
Suppose the explorer makes three
trips $1/6$ day into the desert, dropping $2/3$ gallon off units each
time.  On the third trip, the cache has 2 gallons of water, and the
explorer still has $1/6$ gallon for the trip back home.  So, instead of
returning immediately, she uses the solution described above to
advance another $3/4$ of a day into the desert and then returns home.
Thus, she reaches 
%
\[
\frac{1}{6} + \frac{1}{4} + \frac{1}{2} = \frac{11}{12}
\]
%
of a days' walk into the desert.
\end{solution}
\fi

\ppart The explorer will travel using a recursive strategy to go far into
the desert and back drawing a total of $n$ gallons of water from the
oasis.  Her strategy is to build up a cache of $n-1$ gallons, plus enough
to get home, a certain fraction of a day's distance into the desert.  On
the last delivery to the cache, instead of returning home, she proceeds
recursively with her $n-1$ gallon strategy to go farther into the desert
and return to the cache.  At this point, the cache has just enough water
left to get her home.

Prove that with $n$ gallons of water, this strategy will get her $H_n / 2$
days into the desert and back, where $H_n$ is the $n$th Harmonic number:
\[
H_n \eqdef \frac{1}{1} + \frac{1}{2} + \frac{1}{3} + \cdots + \frac{1}{n}.
\]
Conclude that she can reach the shrine, however far it is from the oasis.

\begin{solution}
To build up the first cache of $n-1$ gallons, she should make
  $n$ trips $1/(2n)$ days into the desert, dropping off $(n-1)/n$ gallons
  each time.  Before she leaves the cache for the last time, she has $n-1$
  gallons plus enough for the walk home.  Then she applies her $(n-1)$-day
  strategy.  So letting $D_n$ be her maximum distance into the desert and
  back, we have
%
\[
D_n = \frac{1}{2n} + D_{n-1}.
\]
So
\begin{align*}
D_n & = \frac{1}{2n} + \frac{1}{2(n-1)} + \frac{1}{2(n-2)}+ \cdots +
\frac{1}{2\cdot 2} +\frac{1}{2 \cdot 1}\\
  & = \frac{1}{2} \paren{ \frac{1}{n} + \frac{1}{(n-1)} + \frac{1}{(n-2)}+ \cdots +
\frac{1}{\cdot 2} +\frac{1}{ \cdot 1}}\\
  & = \frac{H_n}{2}.
\end{align*}

\end{solution}

\ppart Suppose that the shrine is $d = 10$ days walk into the desert.  Use
the asymptotic approximation $H_n \sim \ln n$ to show that it will take
more than a million years for the explorer to recover the Holy Grail.

\begin{solution}
She obtains the Grail when:
%
\[
\frac{H_n}{2} \approx \frac{\ln n}{2} \geq 10.
\]
%
This requires $n \geq e^{20} = 4.8 \cdot 10^8\text{ days } > 1.329M\text{ years}$.

\end{solution}

\eparts
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
