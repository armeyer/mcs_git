\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_tournament_chain}
  \pcomment{subsumes CP_tournament_chain_induction but requires DAGs}
  \pcomment{from ps4.S10}
  \pcomment{substantially revised by ARM 3/8-10/11}
  \pcomment{by ARM 10/17/09 but I saw it somewhere}
  \pcomment{part(d) soln revised by ARM 3/28/13}
\end{pcomments}

\pkeywords{
  digraphs
  DAG
  acyclic
  relation
  ranking
  tournament
  rationals
  path
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem} %\textbf{Tournament Graphs}
  In a round-robin tournament, every two distinct players play against
  each other just once.  For a round-robin tournament with no
  tied games, a record of who beat whom can be described with a
  \term{tournament digraph}, where the vertices correspond to players
  and there is an edge $\diredge{x}{y}$ iff $x$ beat $y$ in their
  game.

  A \term*{ranking} is a path that includes all the players.  So in a
  ranking, each player won the game against the next lowest ranked
  player, but may very well have lost their games against much lower
  ranked players---whoever does the ranking may have a lot of room to
  play favorites.
  
\begin{staffnotes}
 Paths used to be called ``simple paths'' or ``\emph{directed} simple
 paths.''
\end{staffnotes}

\bparts

\ppart Give an example of a tournament digraph with more than one
ranking.

\begin{solution}
  Let $n=3$ with edges $\diredge{u}{v}$, $\diredge{v}{w}$ and
  $\diredge{w}{u}$.  Then both~$u,v,w$ and $v,w,u$ are rankings.
\end{solution}

\begin{editingnotes}
The two parts could be given in either order.
\end{editingnotes}

\ppart Prove that if a tournament digraph is a DAG, then it has at
most one ranking.

\begin{solution}
The most direct proof goes as follows: given a ranking in a tournament
graph, if $u$ ranks higher than $v$, and $v$ ranks higher than $w$,
then if $w$ beat $u$ in their game, there would be a length three cycle
from $u$ to $v$ to $w$ and back to $u$.  So in a tournament
\emph{DAG}, higher ranking players must have beaten all lower ranking
players.  This of course is the same as saying that all lower ranking
players were beaten by all higher ranking players.  So there is no
choice on how to rank a player: if the player lost $k$ matches, they
must be the $k+1$st ranked player.

Another straighforward proof is by contradiction.  Suppose that there
are two rankings for the graph.  Since the rankings differ, there must
be two players~$u \neq v$ such that~$u$ ranks higher than $v$ in one
ranking and lower than $v$ in the other ranking.  So one ranking gives
a path from~$u$ to $v$ and the other ranking gives a path from $v$
to~$u$.  Merging these paths gives a closed \emph{walk} from~$u$
to~$u$ that goes through $v$. \textcolor{red}{\emph{A common mistake
    at this point is to assume that this closed walk is a cycle, but
    it may not be (see Problem~\bref{CP_shortest_directed_closed_walk}).}} Since $v \neq
u$, this walk has positive length, and
Lemma~\bref{shortestclosedwalk_lem} implies that there is a cycle from
$u$ to $u$ (somewhere, not necessarily including $v$).  This
contradicts the fact that the graph is a DAG, which completes the
proof by contradiction.

Another way to close the loophole above without appeal to
Lemma~\bref{shortestclosedwalk_lem} is to observe that in a tournament
graph, there must be an \emph{edge} in one direction or the other
between $u$ and $v$.  So say the edge is $\diredge{u}{v}$.  Then this
edge merged with the path from $v$ to $u$ must be a cycle.\footnote{If
  this isn't obvious to you, take a moment to think again.}

By the way, yet another workable approach to this problem is by
induction on the number of vertices\ldots
\end{solution}

\ppart\label{hasrank} Prove that every finite tournament digraph has a
ranking.

\begin{staffnotes}
\hint Induction on the size of the tournament.  Could also rephrase
the proof below by considering a maximum length ranking.
\end{staffnotes}

\begin{solution}
By induction on $n$ with induction hypothesis
\[
P(n) \eqdef \text{every tournament digraph with $n$ vertices has a
  ranking.}
\]
 
\inductioncase{base case} ($n=1$):  Trivial.

\inductioncase{inductive step}:  Let $G$ be a tournament digraph with $n+1$
vertices.  Remove one vertex,~$v$, to obtain the subgraph $H$ with the
$n$ remaining vertices.  Since removing~$v$ does not change the edges
between the remaining vertices, $H$ is also a tournament digraph.  So by
induction hypothesis $H$ has a ranking.  Now if the last player in this
$H$-ranking beat player~$v$, then~$v$ can be added at the end to form a
ranking in $G$.  On the other hand, if~$v$ beat the last player in the
$H$-ranking, then there will (by WOP) be a first player in the $H$-ranking
that~$v$ beats.  Inserting~$v$ just before that first player gives a
ranking for $G$.  Since $G$ was an arbitrary $n+1$ vertex tournament
graph, we conclude that $P(n+1)$ holds, which completes the proof.
\end{solution}

\inmcsprob{
\begin{center}
{\large Optional}
\end{center}

\ppart Prove that the greater-than relation $>$ on the
rational numbers $\rationals$ is a DAG and a tournament graph
that has no ranking.

\begin{staffnotes}
Intervene if teams start to spend much time on this part.  Tell them
we mostly will focus on finite graphs, and in general, infinite
counter-examples like this are not particularly important.

On the other hand, to really understand a proof, you need to be aware
where the proof depends on finiteness (whether it needs to or not).
\end{staffnotes}

\begin{solution}
Regarding the $>$-relation as a digraph, we have an edge from $r$ to
$s$ iff there is a positive length path from $r$ to $s$ iff $r >s$.

The $>$-relation defines a tournament graph on $\rationals$ since for
every two rationals $r \neq s$, either $r > s$ so there is an edge
from $r$ to $s$, or $r< s$ so there is an edge from $s$ to $r$.  

The digraph cannot have any cycles, since any $r$ on a cycle would be
greater than itself.

Now suppose for the sake of contradiction that there was a path that
was a ranking.  Let $r$ and $s$ be consecutive elements on the path,
that is, $\diredge{r}{s}$ is an edge of the path.  This implies that
$r >s$.  Now suppose $t$ is a rational number such that $r > t > s$.
There is no path at all in the $>$-digraph from $t$ to $r$, and so $t$
must come after $r$ on the ranking path.  Likewise, there is no path
at all from $s$ to $t$, so $t$ must come before $r$ on the ranking
path.  So $t$ must appear on the ranking path between $r$ and $s$,
contradicting the fact that $r$ and $s$ are consecutive vertices on
the ranking path.  Thus there cannot be a path that is a ranking of
all the rational numbers.
\end{solution}
}

\eparts
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
