\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_expected_number_of_keys_deviation_no_replace_backref}
  \pcomment{overlaps CP_expected_number_of_keys, PS_n_keys, refers to CP_expected_number_of_keys_deviation_no_replace}
  \pcomment{ARM 12/19/15, 9/28/16}
\end{pcomments}

\pkeywords{
  random_variable
  expectation
  indicator_variable
  failure
  deviation
  variance
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
A man has a set of $n$ keys, one of which fits the door to his
apartment.  He tries the keys randomly throwing away each ill-fitting
key that he tries until he finds the key that fits.  That is, he
chooses keys randomly from among those he has not yet tried.
This way he is sure to find the right key within $n$ tries.

Let $T$ be the number of times he tries keys until he finds the right
key.  Problem~\bref{CP_expected_number_of_keys} shows that
\[
\expect{T} = \frac{n+1}{2}.
\]
Write a closed formula for $\variance{T}$.

\begin{solution}
\begin{align*}
\variance{T} & = \expectsq{T} - \expect{T}^2,\\
\expectsq{T}
   & \eqdef \sum_{k=1}^n k^2\pr{T=k}\\
   & = \sum_{k=1}^n k^2\frac{1}{n} %& \text{(part~\eqref{prT=k1nnr})}\\
   & = \frac{\sum_{k=1}^n k^2}{n}\\
   & = \frac{n(n+1)(2n+1)}{6n}
           & \text{(Problem~\bref{CP_sum_of_squares} or \bref{CP_gen_func_sum_of_squares})}\\
   & = \frac{(n+1)(2n+1)}{6}.
\variance{T}
    & = \frac{(n+1)(2n+1)}{6} - \paren{\frac{n+1}{2}}^2\\
    & = n(n+1)\frac{n - 1}{12n}
%\frac{\binom{n}{3}}{2n}
         & \text{(algebra)}.
\end{align*}
\end{solution}

\begin{staffnotes}
\begin{align*}
\lefteqn{\frac{n(n+1)(2n+1)}{6n} - \paren{\frac{n+1}{2}}^2}\\
& = n(n+1)\frac{2(2n+1)}{12n} - \frac{3n(n+1)^2}{12n}\\
& = n(n+1)\paren{\frac{4n+2}{12n} - \frac{3(n+1)}{12n}}\\
& = n(n+1)\frac{4n+2 - 3n-3}{12n}\\
& = n(n+1)\frac{n - 1}{12n}\\
& = \frac{\binom{n}{3}}{2n}
\end{align*}

\end{staffnotes}

\end{problem}

\endinput
