\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_chinese_remainder}
  \pcomment{used to appear as first part of PS_Euler_function_multiplicativity}
  \pcomment{by ARM 2/27/11; revised 3/2/11}
\end{pcomments}

\pkeywords{
  prime
  relatively_prime
  number_theory
  modular_arithmetic
  chinese_remainder
  remainder
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
  Suppose $a, b$ are relatively prime and greater than 1.  In this
  problem you will prove the \term{Chinese Remainder Theorem}, which
  says that for all $m,n$, there is an $x$ such that
\begin{alignat}{2}
   x &\equiv m &\ \pmod\ a,\label{xma}\\
   x &\equiv n &\ \pmod\ b.\label{xnb}
\end{alignat}
  Moreover, $x$ is unique up to congruence modulo $ab$, namely, if
  $x^\prime$ also satisfies~\eqref{xma} and~\eqref{xnb}, then
\[
x^\prime \equiv x \pmod{ab}.
\]

\bparts

\ppart\label{exmaxnb} Prove that for any $m,n$, there is some $x$
satisfying~\eqref{xma} and~\eqref{xnb}.

\hint Let $b^{-1}$ be an inverse of $b$ modulo $a$ and define $e_a \eqdef
b^{-1}b$.  Define $e_b$ similarly.  Let $x = me_a + ne_b$.

\begin{solution}
We have by definition
\[
e_a \eqdef b^{-1}b \equiv
\begin{cases}
  1 \pmod a,\\
  0 \pmod b,
\end{cases}
\]
and likewise for $e_b$.  Therefore
\[
m e_a+ n e_b \equiv \begin{cases}
                 m\cdot 1 + n \cdot 0 = m \bmod a\\
                 m\cdot 0 + n \cdot 1 = n \bmod b.
                    \end{cases}
\]
\end{solution}

\ppart\label{0congcase} Prove that
\[
\brac{x \equiv 0 \pmod a \ \QAND\  x \equiv 0 \pmod b} \qimplies x \equiv 0 \pmod{ab}.
\]

\begin{solution}
  If $x \equiv 0 \pmod a$, then by definition, $a \divides x$.  Likewise,
  $b \divides x$.  But $a$ and $b$ are relatively prime, so by Unique
  Factorization~\bref{thm:unique_factor}, $ab \divides x$, that is, $x
  \equiv 0 \pmod {ab}$.
\end{solution}

\ppart\label{x0x1mab} Conclude that
\[
\brac{x \equiv x^\prime \pmod{a}\ \QAND\ x \equiv x^\prime \pmod b} \qimplies
x \equiv x^\prime \pmod{ab}.
\]

\begin{staffnotes}
If needed suggest ``Look at $x^\prime - x$.''
\end{staffnotes}
\begin{solution}

$(x^\prime - x)$ is congruent to $0 \bmod a$ by~\eqref{xma} and
  congruent to $ 0 \bmod b$ by~\eqref{xnb}, so by
  part~\eqref{0congcase}, $(x^\prime-x) \equiv 0 \pmod{ab}$.  Adding
  $x$ to both sides of this congruence gives
\[
x^\prime \equiv x \pmod{ab}.
\]
\end{solution}

\ppart Conclude that the Chinese Remainder Theorem is true.
\begin{solution}
  The existence of an $x$ is given in part~\eqref{exmaxnb}, so all that's
  left is to prove $x$ is unique up to congruence modulo $ab$.  But if $x$
  and $x^\prime$ both satisfy~\eqref{xma} and~\eqref{xnb}, then $x^\prime
  \equiv x \pmod {a}$ and $x^\prime \equiv x \pmod {b}$, so $x^\prime
  \equiv x \pmod{ab}$ by part~\eqref{x0x1mab}.

\textbf{The Chinese Remainder Theorem underlies a way of reducing
  arithmetic calculations with ``large'' numbers into parallel
  calculations with ``small'' numbers at a significant gain in speed
  and effort.  Refer to Problem~\bref{CP_chinese_remainder_general}
  for a discussion.}

\end{solution}

\ppart\label{xempab} What about the converse of the implication in part~\eqref{x0x1mab}?

\begin{solution}
The converse is true too: if $cd$ divides $(x^\prime - x)$, then $c$
itself must also be a divisor of $(x^\prime - x)$.  This means that
\[
x^\prime \equiv x \pmod{cd} \qimplies x^\prime \equiv x \pmod{c}.
\]
So in particular,
\[
x \equiv x^\prime \pmod{ab} \qimplies \brac{x \equiv x^\prime \pmod a
  \ \QAND\ x \equiv x^\prime \pmod b}.
\]

\iffalse
So this together with part~\eqref{x0x1mab} gives a basic fact worth calling
a
\begin{lemma*}
For $a, b$ relatively prime and greater than 1,
\[
\brac{x^\prime \equiv x \pmod{a} \ \QAND\  x^\prime \equiv x \pmod{b}}
\qiff x^\prime \equiv x \pmod{ab}.
\]
\end{lemma*}
\fi

\end{solution}

\iffalse
\ppart Conclude that there is a \emph{unique} $x \in \Zintvco{0}{ab}$
  satisfying~\eqref{xma} and~\eqref{xnb}.

\begin{solution}
By part~\eqref{x0x1mab}, if $x^\prime$ and $x$ both
satisfy~\eqref{xma} and~\eqref{xnb}, then they are congruent
$\bmod{ab}$.  Since none of the numbers in $\Zintvco{0}{ab}$ are
congruent $\bmod{ab}$, it follows that if $x^\prime$ and $x$ are both
in $\Zintvco{0}{ab}$, they must be equal.

An alternative argument is that the function $f: \Zintvco{0}{ab} \to
\Zintvco{0}{a} \cross \Zintvco{0}{b}$ defined by
\[
f(x} \eqdef (\rem{x}{a},\rem{x}{b})
\]
is a surjection by part~\eqref{xin0ab}, and since the domain and
codomain are both of size $ab$, it must be a bijection.  That means
that $f^{-1}(m,n)$ is the unique $x \in \Zintvco{0}{ab}$ satisfying~\eqref{xma}
  and~\eqref{xnb}.

\end{solution}
\fi

\eparts
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
