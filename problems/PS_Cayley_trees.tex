\documentclass[problem]{mcs}

\begin{pcomments}
\pcomment{PS_Cayley_trees}
\pcomment{BUGGY DRAFT by Chinmay Hegde, 3/18/14}
\end{pcomments}

\pkeywords{
 tree
 Cayley
 counting
 rooted
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{editingnotes}
Garbled draft based on Proofs from the Book.  Fix may be too
complicated to use as a problem.
\end{editingnotes}

\begin{problem}
Suppose that we are given a set of $n$ different vertices.  What is
the number $\tau(n)$ of distinct trees that can be formed using
these vertices?  A beautiful result by Cayley states that
\[
\tau(n) = n^{n-2}.
\]
There are several ways to arrive at this result, and in this problem
we will derive a particularly nice proof.  This problem also
illustrates the ``counting-by-two-ways'' principle that we will
encounter in the course.

Let $T$ be a tree formed using the $n$ vertices.  Define a
\emph{rooted tree} to be the pair $(T,r)$, where $r$ is a designated
``root'' vertex of $T$.

\bparts

\ppart\label{num_edge_sequences1} We can form any rooted tree $(T,r)$
by starting with the empty graph on $n$ vertices, and adding to it a
sequence of $n-1$ edges.  Calculate the number $E(n)$ of possible such edge
sequences.  Express your answer in terms of $\tau(n)$.

\begin{solution}
Fix any pair $(T,r)$.  There are $\tau(n)$ choices for $T$, and $n$
choices for $r$.  Once $T$ is fixed, its $n-1$ edges can be
constructed in any order.  There are $(n-1)!$ such sequences
possible.  Therefore, the total number is given by
\[
E(n) = \tau(n) \cdot n \cdot (n-1)! = n! \cdot \tau(n).
\]
\end{solution}

\ppart\label{nminusk_forest} We also have a different way to count the
number of possible sequences generated in constructing a given rooted
tree.  Suppose that $k$ edges have been added to the empty graph, for
some $k \geq 1$.  Show that the subgraph formed by these edges is a
forest with $n-k$ components.

\begin{solution}
The empty graph can be viewed as a ``forest'' with $n$ components.
Every addition of an edge reduces the number of connected components
by 1.  Each component is a subgraph of the final tree $T$, and
therefore is itself a tree.  After $k$ added edges, the number of
components reduces to $n-k$.
\end{solution}

\ppart Suppose that $m-1$ edges have been added for some $m \geq 1$.
What is the number of possible choices for the next edge in the
sequence?

\begin{solution}
Part~\eqref{nminusk_forest} shows that after $m-1$ edges have been
added, there are $(n-m+1)$ connected components.  To choose the next
edge, we can pick any vertex $v$ among the $n$ vertices, and join it
to the roots of any of the $n-m$ components \emph{other} than the root
of the connected component to which $v$ belongs (if the root of the
component containing $v$ is chosen, this would form a cycle).
Therefore, there are $n \cdot (n-m)$ choices for the next edge of the
sequence.
\end{solution}

\ppart\label{num_edge_sequences2}
Compute the product over $m \in \Zintvco{1}{n}$ to find the total number of
possible edge sequences.  Compare with your expression for $E(n)$,
and deduce Cayley's result as a consequence.

\begin{solution}
The product over $m$ is given by 
\[
\prod_{m=1}^{n-1} n(n-m) = n^{n-1} (n-1)! = n^{n-2} \cdot n \cdot (n-1)! = n! \cdot n^{n-2}.
\]
Comparing with the expression obtained for $E(n)$ obtained in
part~\eqref{num_edge_sequences1}, we get
\[
E(n) = n! \cdot \tau(n) = n! \cdot n^{n-2},
\]
so
\[
\tau(n) = n^{n-2}.
\]
\end{solution}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
