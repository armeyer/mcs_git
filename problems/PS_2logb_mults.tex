\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_2logb_mults}
  \pcomment{by ARM 2/20/11}
\end{pcomments}

\pkeywords{
  strong_induction
  fast_exponentiation
  exponent
  induction
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
 Prove that the fast exponentiation state machine of
  Section~\bref{fast_exp_subsubsec} will halt after
\begin{equation}\label{clog2n1}
\ceil{\log_2 n}+1
\end{equation}
transitions starting from any state where the value of $z$ is $n \in \integers^+$.

\hint Strong induction.

\begin{solution}
Notice that the number of transitions is determined solely by the value of
$z$, so we can define
\[
t(n) \eqdef \text{\#transitions until $z=0$ from a state with $z=n$}.
\]

We prove that~\eqref{clog2n1} hold for all $n \in integers^+$ by strong
induction.

\textbf{base case} ($n=1$): $t(1) = 1 = \ceil{\log_2 1}+1$,
so~\eqref{clog2n1} holds in this case.

\textbf{inductive step}:
\begin{align*}
t(n+1) & = 1 + t(\floor{(n+1)/2}) 
                 & \text{(by def of the transitions)}\\
     & \le 1+ (\ceil{\log_2 \floor{(n+1)/2}}+1) 
                 & \text{(by strong induction since $\floor{(n+1)/2} \le n$)}\\
     & \le 1+ (\ceil{\log_2 (n+1)/2}+1)\\
     &  =  1+ (\ceil{(\log_2 (n+1)}- 1) +1)\\
     &  =  1 + (\ceil{\log_2 (n+1)}),
\end{align*}
confirming that,~\eqref{clog2n1} holds when $n$ is replaced by $n+1$, as required.

This completes the induction step, so by the Strong Induction Principle,
we conclude that~\eqref{clog2n1} holds for all $n \in \integers^+$.
\end{solution}

\end{problem}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput



