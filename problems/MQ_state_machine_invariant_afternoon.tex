\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{MQ_state_machine_invariant_afternoon}
  \pcomment{similar to CP_state_machine_multiply}
  \pcomment{soln edited ---ARM, 3/7/13}
\end{pcomments}

\pkeywords{
  state_machines
  termination
  partial_correctness
  invariant
  algorithm
  multiply
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
The following state machine describes a procedure that terminates with the
product of two nonnegative integers $x$ and $y$ in register $a$.  Its
states are triples of nonnegative integers $(r,s,a)$.  The initial state
is $(x,y,0)$.  The transitions are given by the rule that for $s>0$:
\[
(r,s,a)\rightarrow\begin{cases}
        (2r,s/2,a) &\text{if $s$ is even},\\
        (2r,(s-1)/2,a+r) &\text{otherwise}.
       \end{cases}
\]

Circle the predicates below that are preserved invariants for
this state machine:
\begin{itemize}
\item $[a > 0]$
\item $[r < 0]$
\item $[r = 0]$
\item $[s+a = xy]$
\item $[r+a = s]$
\item $[rs+a = xy]$
\end{itemize}

\begin{solution}
$[a > 0]$ is a preserved invariant since $a$ stays the same or
  increases by $r\geq 0$ at each transition.

$[r < 0]$ is a preserved invariant since it is always false.

$[r = 0]$ is a preserved invariant since $r$ just gets doubled at each
  transition.  ($[r >0]$ is a preserved invariant for the same
  reason.)

$[rs+a = xy]$ is the preserved invariant that could be used to verify
  partial correctness.

But $[s+a = xy]$ is not preserved, because, for example, $(1,5,0) \movesto (2,2,1)$.

And likewise $[r+a = s]$ is not preserved because, for example,
$(1,1,0) \movesto (2,0,1)$.

\end{solution}

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
