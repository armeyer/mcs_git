\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_self-inverse_mod_p}
  \pcomment{S15.ps5, S09.ps7, OCW 05}
\end{pcomments}

\pkeywords{
  number_theory
  modular_arithmetic
  primes
  inverse
  Wilson
  Gauss
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem} Suppose that $p$ is a prime and $0<k<p$.

\bparts

\ppart $k$ is \emph{self-inverse} if $k^2 \equiv 1 \pmod {p}$.  Prove that
$k$ is self-inverse iff either $k = 1$ or $k = p - 1$.

\hint $k^2-1 = (k-1)(k+1)$

\begin{solution}
By definition of $\equiv \pmod {p}$, the integer $k$ is
self-inverse iff $p \divides k^2 - 1$.  But $k^2-1 = (k-1)(k+1)$, and
since $p$ is a prime, we conclude that either $p \divides k-1$ or $p
\divides k+1$.  But $0 < k < p$, so $p \divides k-1$ iff $k-1=0$, and $p
\divides k+1$ iff $k+1 = p$, so we must have $k = 1$ or $k = p - 1$.

Conversely, $1 \cdot 1 \equiv 1 \pmod{p}$ and $(p-1)\cdot (p-1) = p^2+2p+1
\equiv 1 \pmod{p}$.
\end{solution}

\ppart The English mathematician Edward Waring said that the following
theorem would probably be very difficult to prove because there was no
adequate notation for primes.  Gauss then proved it (while standing on
one foot, it is rumored); he suggested that Waring failed for lack of
notions, not notations.
\begin{theorem*}[Wilson's Theorem]
If $p$ is a prime, then
\[
(p - 1)!\  \equiv  -1 \pmod{p}
\]
\end{theorem*}

Prove Wilson's Theorem.  \hint While standing
on one foot, think about pairing each term in $(p-1)!$ with its
multiplicative inverse.

\begin{solution}
If $p = 2$, then the theorem holds, because $1 \equiv -1
\pmod{2}$.  If $p > 2$, then $p - 1$ and $1$ are distinct terms in the
product $1 \cdot 2 \cdot \cdots (p - 1)$, and these are the only
self-inverses.  Consequently, we can pair each of the remaining terms
with its unique\footnote{See Lemma~\ref{uniq-inv}.} multiplicative inverse.

Since the product of a number and its inverse is congruent to 1, all
of these remaining terms cancel.  Therefore, we have:

\begin{align*}
(p-1)!  & \equiv  1 \cdot (p - 1) \pmod{p} \\
        & \equiv  -1 \pmod{p}
\end{align*}
	
\end{solution}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
