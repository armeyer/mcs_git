\documentclass[problem]{mcs}

\begin{pcomments}
 \pcomment{CP_independent_product}
 \pcomment{from: S09.cp14m}
\end{pcomments}

\pkeywords{
  expectation
  independent
  product
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}

Justify each line of the following proof
\iffalse  \instatements{(without
  looking it up in Theorem~\ref{th:prod})}
\fi
that if $R$ and $S$ are
\emph{independent} random variables, then
\[
\expect{R \cdot S} = \expect{R} \cdot \expect{S}.
\]

\begin{proof}
\begin{align*}
\lefteqn{\expect{R \cdot S}}\\
 & =  \sum_{t \in \range{R\cdot S}} t\cdot \pr{R\cdot S=t}\\
 & =  \sum_{r \in \range{R},\ s \in \range{S}}
            r s \cdot \pr{R=r\ \text{and}\ S=s}\\
 & =  \sum_{r \in \range{R}} \paren{\sum_{s \in \range{S}}
            r s \cdot \pr{R=r\ \text{and}\ S=s}}\\
 & =  \sum_{r \in \range{R}} \paren{\sum_{s \in \range{S}}
            r s \cdot \pr{R=r}\cdot \pr{S=s}}\\
 & =  \sum_{r \in \range{R}} \paren{r\pr{R=r} \cdot
              \sum_{s \in \range{S}} s \pr{S=s}}\\
 & =  \sum_{r \in \range{R}} r\pr{R=r} \cdot \expect{S}\\
 & =   \expect{S} \cdot \sum_{r \in \range{R}} r\pr{R=r}\\
 & =   \expect{S} \cdot  \expect{R}.
\end{align*}

\end{proof}

\begin{solution}
Note that the event $[R \cdot S=t]$ is the disjoint union of events
$[R = r \QAND S = s]$ such that $r \in \range{R}, s \in \range{S}$ and
$r s = t$.

\iffalse
\begin{equation}\label{rr1r2}
[R \cdot S=t] = \lgunion_{r s = t} [R = r \QAND S = s]
\end{equation}
\fi

\begin{proof}
\begin{align*}
\lefteqn{\expect{R \cdot S}}\\
 & \eqdef \sum_{t \in \range{R\cdot S}} t\cdot \pr{R\cdot S=t}
        & \text{(by definition)}\\
 & =  \sum_{r \in \range{R},\, s \in \range{S}}
            r s \cdot \pr{R=r \QAND S=s}
        & \text{(remarked above)}\\
 & =  \sum_{r \in \range{R}} \paren{\sum_{s \in \range{S}}
            r s \cdot \pr{R=r \QAND S=s}}
       & \text{(reordering terms)}\\
 & =  \sum_{r \in \range{R}} \paren{\sum_{s \in \range{S}}
            r s \cdot \pr{R=r}\cdot \pr{S=s}}
       & \text{(independence of $R,S$)}\\
 & =  \sum_{r \in \range{R}} \paren{r\pr{R=r} \cdot
              \sum_{s \in \range{S}} s \pr{S=s}}
       &\text{(factor out $r\pr{R=r}$)}\\
 & =  \sum_{r \in \range{R}} r\pr{R=r} \cdot \expect{S}
       &\text{(def of $\expect{S}$)}\\
 & =  \expect{S} \cdot \sum_{r \in \range{R}} r\pr{R=r}
           & \text{(factor out $\expect{S}$)}\\
 & =  \expect{S} \cdot  \expect{R}.
                 & \text{(def of $\expect{R}$)}
\end{align*}

\end{proof}
\end{solution}

%\eparts
\end{problem}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
