\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{MQ_counting_paths_with_obstacles}
  \pcomment{one of many path counting problems}
\end{pcomments}

\pkeywords{
  inclusion-exclusion
  path

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
A spacecraft is traveling through otherwise-empty three-dimensional
space.  It can move along only one dimension at a time, stepping
precisely one unit in the positive direction along that dimension with
each movement.  For any two points $P$ and $Q$ in space, let
$p_{P,Q}$ denote the number of distinct paths the spacecraft can
follow to go from $P$ to $Q$.

\begin{problemparts}

\problempart Let $P$ and $Q$ have coordinates $(x_P,y_P,z_P)$ and
$(x_Q,y_Q,z_Q)$, respectively.  Assuming that $p_{P,Q}$ is positive,
express $p_{P,Q}$ \textbf{as a single multinomial coefficient}.

\examspace[2in]

\begin{solution}
Because each of the spacecraft's permissible atomic movements involves
incrementing precisely one of its three position coordinates, $p_{P,Q}
> 0$ implies that $x_Q-x_P$, $y_Q-y_P$ and $z_Q-z_P$ are all
nonnegative integers.  (The converse is also true.)  To go from $P$ to
$Q$, the spacecraft must increment its first position coordinate
$x_Q-x_P$ times, its second $y_Q-y_P$ times and its third $z_Q-z_P$
times.  So it must undergo precisely $(x_Q-x_P)+(y_Q-y_P)+(z_Q-z_P)$
atomic movements, $x_Q-x_P$ of them along the first dimension,
$y_Q-y_P$ of them along the second and $z_Q-z_P$ of them along the
third.

So, number the spacecraft's atomic movements:
$1,2,\ldots,(x_Q-x_P)+(y_Q-y_P)+(z_Q-z_P)$.  Partition the set
$T=\set{1,2,\ldots,(x_Q-x_P)+(y_Q-y_P)+(z_Q-z_P)}$ into three sets,
$T_x$, $T_y$ and $T_z$, such that $\abs{T_x}=x_Q-x_P$,
$\abs{T_y}=y_Q-y_P$, and $\abs{T_z}=z_Q-z_P$.  $T_x$ then specifies
which atomic movements are along the first dimension, $T_y$ does the
same for the second dimension, and $T_z$ for the third.  Each distinct
partition corresponds to a single permissible path from $P$ to $Q$,
and each permissible path from $P$ to $Q$ corresponds to a single
partition.  So the number of permissible paths from $P$ to $Q$ is just
the number of distinct partitions -- that is, the number of
$(x_Q-x_P,y_Q-y_P,z_Q-z_P)$-splits of the
$\paren{(x_Q-x_P)+(y_Q-y_P)+(z_Q-z_P)}$-element set $T$.  And of
course this number is just:

\[
p_{P,Q}=\binom{(x_Q-x_P)+(y_Q-y_P)+(z_Q-z_P)}{x_Q-x_P,y_Q-y_P,z_Q-z_P}
\]

Alternatively, consider a bijection between the set of possible paths
from $P$ to $Q$ and the set of sequences of length
$(x_Q-x_P)+(y_Q-y_P)+(z_Q-z_P)$ that contain $(x_Q-x_P)$ $1$s,
$(y_Q-y_P)$ $2$s, and $(z_Q-z_P)$ $3$s.  The $k$th term of each
sequence specifies the dimension associated with the $k$th atomic
movement in the corresponding path.  The Bookkeeper Rule then leads
directly to the expression for $p_{P,Q}$.
\end{solution}

\problempart Suppose there exist five points in space $A$, $B$, $C$,
$D$ and $E$, such that it is possible for the spacecraft to travel
from $A$ to $B$, from $B$ to $C$, from $C$ to $D$ and from $D$ to
$E$.  Write an expression for the number of distinct paths the
spacecraft can follow to go from $A$ to $E$ while \textbf{avoiding}
$B$, $C$ and $D$.  Your expression \textbf{must} be written entirely
in terms of symbols of the form $p_{P,Q}$, where
$P,Q\in\set{A,B,C,D,E}$.

\hint Inclusion-Exclusion.

\examspace[3in]

\begin{solution}
First, note that since it is possible for the spacecraft to travel
from $A$ to $B$, from $B$ to $C$, from $C$ to $D$ and from $D$ to
$E$, therefore paths exist from $A$ to each of $A$, $B$, $C$, $D$ and
$E$, from $B$ to each of $C$, $D$ and $E$, from $C$ to \dots, and from $E$ to
$E$.  Thus, because of the way in which the spacecraft must move,
positive-length paths cannot exist from $E$ to $A$, $B$, $C$, $D$ or
$E$, from $D$ to $A$, $B$, $C$ or $D$, from $C$ to \dots, or from $A$ to
$A$. (This is why, in what follows, terms like $p_{B,D}$ appear, but
terms like $p_{D,B}$ do not.  If $B$ and $D$ are distinct, $p_{B,D}$
is positive and $p_{D,B}$ is zero, so including $p_{D,B}$ would affect
nothing.  If $B$ and $D$ are coincident, both $p_{B,D}$ and $p_{D,B}$
are equal to one, but considering both would amount to counting every
path through $B$ twice.)  In a very loose sense, and if cases
involving coincident points are ignored, this essentially means that
the spacecraft only moves ``forward'' and that $B$ is ``ahead'' of
$A$, $C$ is ``ahead'' of $B$, $D$ is ``ahead'' of $C$ and $E$ is
``ahead'' of $D$.

Let $S$ denote the set of all paths from $A$ to $E$.  Clearly, $\card{S} = p_{A,E}$.

Let $S_X$ denote the set of all paths that go from $A$ to $E$, through
$X$, where $X\in\set{B,C,D}$.  Evidently, $\card{S}_X = p_{A,X}p_{X,E}$.

Now, $S_X \intersect S_Y$ is the set of paths that go from $A$ to $E$,
through both $X$ and $Y$, where $X,Y\in\set{B,C,D}$.  Obviously,
$\card{S_B \intersect S_C} = p_{A,B}p_{B,C}p_{C,E}$, $\card{S_B \intersect S_D} =
p_{A,B}p_{B,D}p_{D,E}$, and $\card{S_C \intersect S_D} = p_{A,C}p_{C,D}p_{D,E}$.

Also, $S_B \intersect S_C \intersect S_D$ is the set of all paths that
go from $A$ to $E$, through all three of $B$, $C$ and $D$.
Obviously, $\card{S_B \intersect S_C \intersect S_D} =
p_{A,B}p_{B,C}p_{C,D}p_{D,E}$.

Now, the set of paths that go from $A$ to $E$ and pass through at
least one of $B$, $C$ and $D$, is just $S_B\union S_C\union S_D$.  By
inclusion-exclusion,
\begin{align*}
\card{S_B\union S_C\union S_D}
 & = \card{S_B} + \card{S_C} + \card{S_D} - 
     \card{S_B \intersect S_C} - \card{S_B \intersect S_D} -
     \card{S_C \intersect S_D} + \card{S_B \intersect S_C \intersect S_D}\\
 & = p_{A,B} p_{B,E} + p_{A,C} p_{C,E} + p_{A,D} p_{D,E}\\
 & \qquad - p_{A,B} p_{B,C} p_{C,E} - p_{A,B} p_{B,D} p_{D,E}
         - p_{A,C} p_{C,D} p_{D,E} + p_{A,B} p_{B,C} p_{C,D} p_{D,E}
\end{align*}

Let $R$ denote the set of all paths from $A$ to $E$ that go through
neither $B$, nor $C$, nor $D$.  Evidently, $S = R \union \paren{S_B
  \union S_C \union S_D}$ and $R \intersect \paren{S_B \union S_C
  \union S_D} = \emptyset$.  Therefore $\card{S} = \card{R} +
\card{S_B \union S_C \union S_D}$, so the number of distinct paths the
spacecraft can follow to go from $A$ to $E$ while avoiding $B$, $C$
and $D$ is
\begin{align*}
\card{R}
    & = \card{S} - \card{S_B \union S_C \union S_D} \\
    & = p_{A,E} - p_{A,B}p_{B,E} - p_{A,C}p_{C,E} - p_{A,D}p_{D,E} \\ 
    & \qquad + p_{A,B}p_{B,C}p_{C,E} + p_{A,B}p_{B,D}p_{D,E}
            + p_{A,C}p_{C,D}p_{D,E} - p_{A,B}p_{B,C}p_{C,D}p_{D,E}
\end{align*}

\end{solution}

\end{problemparts}

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
