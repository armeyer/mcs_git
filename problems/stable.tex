                 
%%%%%%%%%%%%%%  Fall 2000  Problem Set 5    %%%%%%%%%%%%%%   %%%%%%%%%%%%%%%
\problem
% 5
% Matching, invariant
Consider an instance of the matching problem with $n$ boys and $n$
girls.  Call a person {\em unlucky} if he or she is matched up with
one of his or her $\floor{\frac{n}{2}}$ last choices.  In this
problem, we will prove the following: 
 
{\bf Theorem}  The matching algorithm from class never produces a
matching in which every person is unlucky.

Fix an execution of the matching algorithm.  Define the variables 
$B_i, G_i, i \in \{ 1, 2, \ldots, n \}$ as follows:
\begin{description}
\item $B_i = j$ if the $i$-th boy is currently courting the $j$-th girl
on his list
\item $G_i$ is the number of boys that the $i$-th girl has rejected.
\end{description}

\ppart
Show that $\sum_{i=1} ^n B_i - \sum_{i=1} ^n G_i$ is preserved at each
step of the matching algorithm.

\solution{
\medskip
\textbf{Solution:}
Let $S = \sum_{i=1} ^n B_i - \sum_{i=1} ^n G_i$.  Suppose that at step
$t$, boy $b_i$ proposes to girl $g_j$.  There are three possible outcomes:

If $g_j$ has not had any previous proposals, she must accept.  In this
case, none of the $B_i$s and none of the $G_j$s change, so $S$ is preserved.

If $g_j$ rejects, then $G_j$ increases by 1, $B_i$ increases by 1, and
the other $B$s and $G$s remain the same.  $S$ is preserved again.

If $g_j$ accepts $b_i$ because she likes him better than her current
mate $b_{i'}$, then $G_j$ increases by 1, $B_{i'}$ increases by 1, and
the other $B$s and $G$s remain the same.  $S$ is preserved in this case
as well.
}

\ppart
Formulate an invariant that you can use to prove the theorem, and 
show that your invariant is correct.

\solution{
\medskip
\textbf{Solution:}
Let $P : S = n$.  In the initial state, this is true because everyone is
courting the first girl on their list.  From part (a) it follows that
all transitions preserve the truth value of $P$.  Therefore $P$ is an
invariant.
}

\ppart
Use your invariant to prove the theorem.

\solution{
\medskip
\textbf{Solution:}
We prove the statement by contradiction.  Consider a match M in which
every person is unlucky.  Then:
\begin{description}
\item For every $i \in \{ 1, \ldots, n \}$, 
$B_i \geq \ceil{\frac{n}{2}} + 1$, and
\item For every $i \in \{ 1, \ldots, n \}$,
$G_i \leq \floor{\frac{n}{2}} - 1$.
\end{description}

It follows that $\sum_{i=1} ^n B_i - \sum_{i=1} ^n G_i \geq 2n$.  This
violates the invariant $P$.
}  
