\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_gambler_unfair_forever}
  \pcomment{from: S06.cp14m}
  \pcomment{edited by ARM 5/9/11; cut part(c) recurrence hint 12/9/11}
\end{pcomments}

\pkeywords{
  probability
  total_probability
  random_walk
  gamblers_ruin
  expectation
  play_forever
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
In a gambler's ruin scenario, the gambler makes independent \$1 bets,
where the probability of winning a bet is $p$ and of losing is $q \eqdef
1-p$.  The gambler keeps betting until he goes broke or reaches a
target of $T$ dollars.

Suppose $T=\infty$, that is, the gambler keeps playing until he goes
broke.
\begin{editingnotes}
(Now there may be a positive probability that he actually plays
  forever.)
\end{editingnotes}
Let $r$ be the probability that starting with $n>0$ dollars, the
gambler's stake ever gets reduced to $n-1$ dollars.

\begin{problemparts}

\problempart
Explain why
\[
r = q+ pr^2.
\]

\begin{solution}
By Total Probability
\begin{align*}
r & = \prcond{\text{ever down \$1}}{\text{lose the first bet}}
         \pr{\text{lose the first bet}} \\
 & \qquad + \prcond{\text{ever down \$1}}{\text{win the first bet}}
         \pr{\text{win the first bet}}\\
   & = q +p\prcond{\text{ever down \$1}}{\text{win the first bet}}
\end{align*}

But
\begin{align*}
\lefteqn{\prcond{\text{ever down \$1}}{\text{win the first bet}}}\\
  & = \pr{\text{ever down $\$2$}}\\
  & = \prcond{\text{down another $\$1$}}{\text{already down $\$1$}} \cdot
      \pr{\text{ever down \$1}}
  & = r \cdot r = r^2.
\end{align*}

Note that the problem assumes the more or less obvious fact that $r$
does not depend on $n>0$---which would \emph{not} be true if $T$ was
finite.

A rigorous explanation for this is that, since there is no finite
upper cutoff $T$, any path starting at $n$ and reaching $n-1$ for the
first time could be shifted up or down by $k \in (-n,\infty)$ to be a
path starting at $n+k$ and reaching $(n+k)-1$ for the first time.  Of
course both the orginal and the shifted path have the same
probability.  Hence the probability of all the ways of going down 1
from $n$ is the same as that from $n+k$.
\end{solution}

\begin{staffnotes}
Stimulate a brief discussion of why $r$ is independent of $n>0$.
\end{staffnotes}

\problempart\label{ppart:r-is-one}
Conclude that if $p \leq 1/2$, then $r=1$.

\begin{editingnotes}
\[
r =  \begin{cases}
        1           & \text{if $p \leq 1/2$},\\
        \frac{q}{p} & \text{if $p > 1/2$}.
\end{cases}
\]
\end{editingnotes}

\begin{solution}
The quadratic $pr^2-r+q$ has roots $r=q/p,\ 1$.  So $r=1$ or $r=q/p$.  But $r \leq 1$,
which implies $r=1$ when $q/p \geq 1$, that is, when $p \leq 1/2$.

In fact $r = q/p$ when $q/p < 1$, namely, when $p > 1/2$, but this
requires an additional argument that we omit.
\begin{editingnotes}
Add exercise on this.
\end{editingnotes}
\end{solution}

\problempart Prove that even in a fair game, the gambler is sure to
get ruined \emph{no matter how much money he starts with}!

\begin{solution}
The proof is by induction with hypothesis
\[
P(n) \eqdef \pr{\text{ruin starting with \$$n$}} =1.
\]

\inductioncase{base case} ($n=0$): If the stake is zero, the gambler
is ruined at the start, so $P(0)$ is true by definition.

\inductioncase{inductive step}: If the gambler's initial stake is $n$,
the gambler will be ruined iff his stake gets reduced to $n-1$ and he
gets ruined after that.  But by part~\eqref{ppart:r-is-one}, with
probability 1 the gambler's stake will be reduced to $n-1$, and by
induction hypothesis, he will then be ruined also with probability 1.
Since the intersection of probability 1 events has probability 1,
$P(n)$ holds.

We conclude by induction that $\forall n.\, P(n)$, as claimed.

\end{solution}

\iffalse
\hint  If $r_n$ is probability of ruin starting with stake $n$, then
$r_n = r_{n+1}p + r_{n-1}q$, so
\begin{equation}\label{ruin-recurrence}
r_{n+1} = \frac{r_n}{p} -r_{n-1} \frac{q}{p}.
\end{equation}
\begin{solution}
The gambler gets ruined starting with initial stake $n=1$ precisely if
his initial stake goes down by 1 dollar, so $r_1 =r$ and $r=1$ in the
fair case.  Also $r_0 = 1$ by definition.  Assuming by strong
induction that $r_n=r_{n-1} = 1$, the recurrence~\eqref{ruin-recurrence}
implies that $r_{n+1} = 1/p - (1-p)/p = p/p = 1$.  So $r_n =1$ for all
$n \geq 0$ by strong induction.
\end{solution}
\fi

\problempart Let $t$ be the expected time for the gambler's stake to
go down by 1 dollar.  Verify that
\[
t = q + p(1+2t).
\]
Conclude that starting with a 1 dollar stake in a fair game, the gambler
can expect to play forever!

\begin{solution}
By Total Expectation
\begin{align*}
t & = \expcond{\text{\#steps to be down \$1}}{\text{lose the first
   bet}}\pr{\text{lose the first bet}} +\\
 & \qquad \expcond{\text{\#steps to be down \$1}}
                  {\text{win the first bet}}\pr{\text{win the first bet}}\\
   & = q +p\expcond{\text{\#steps to be down \$1}}
                   {\text{win the first bet}}.
\end{align*}
But
\begin{align*}
\lefteqn{\expcond{\text{\#steps to be down \$1}}{\text{win the first
 bet}}}\\
  & = 1+\expect{\text{\#steps to be down \$2}}\\
  & = 1+\expect{\text{\#steps to be down the first \$1}}
      + \expect{\text{\#steps to be down another \$1}}\\
  & = 1+2t.
\end{align*}
This implies the required formula $t = q + p(1+2t)$.  If $p=1/2$ we
conclude that $t=1+t$, which means $t$ must be infinite.

\end{solution}

\end{problemparts}

\end{problem}

\endinput
