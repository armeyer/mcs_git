\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_gambler_ruin_recurrences}
  \pcomment{revised from: S08.cp13m by ARM, 5/9/10}
  \pcomment{changed \$3 back to \$2 12/14/11 ARM}
\end{pcomments}

\pkeywords{
  probability
  expectation
  random_walk
  gamblers_ruin
  linear_recurrence
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
  A gambler is placing \$1 bets on the ``1st dozen'' in roulette.
  This bet wins when a number from one to twelve comes in, and then
  the gambler gets his \$1 back plus \$2 more.  Recall that there are
  38 numbers on the roulette wheel.

  The gambler's initial stake in $\$n$ and his target is $\$T$.  He
  will keep betting until he runs out of money (``goes broke'') or
  reaches his target.  Let $w_n$ be the probability of the gambler
  winning, that is, reaching target $\$T$ before going broke.

\begin{problemparts}

  \problempart Write a linear recurrence with boundary conditions for
  $w_n$.  You need \emph{not} solve the recurrence.

  \begin{solution}
    The probability of winning a bet is $12/38$.  Thus, by the Law
    of Total Probability~\bref{total_prob_Ebar},
    \begin{align*}
      w_n & = \prcond{\text{win with $\$n$ start}}{\text{won 1st bet}}
                     \cdot \pr{\text{won 1st bet}} \\
         & \quad + \prcond{\text{win with $\$n$ start}}{\text{lost 1st bet}}
                     \cdot\pr{\text{lost 1st bet}}\\
         & = \pr{\text{win with $\$(n+2)$ start}}
                     \cdot \pr{\text{won 1st bet}}\\
         & \quad +\pr{\text{win with $\$(n-1)$ start}}
                     \cdot \pr{\text{lost 1st bet}},
     \end{align*}
    so
    \[
    w_{n} = \frac{12}{38}w_{n+2} + \frac{26}{38}w_{n-1}.
    \]

    Letting $m \eqdef n+2$ we get
    \[
    w_{m} = \frac{38}{12}w_{m-2} - \frac{26}{12}w_{m-3}.
    \]

    As boundary conditions, we have
    \[
    w_0 = 0, w_T = 1, w_{T+1} =1.
    \]
    Notice that for this degree 3 recurrence, three boundary values
    are necessary to determine the $w_n$ uniquely.
\end{solution}

\begin{editingnotes}
  \textcolor{blue}{these seem redundant---ARM}

  \problempart The following is intended to be an approximation of playing
  poker at a table with eight players.  Each bet is \$10.  You win
  \$70 with probability $1/8$.  You lose with probability $7/8$.

  \begin{solution}
\[ w_{n} = (1/8) w_{n+70} + (7/8) w_{n-10} \]
which implies that
\[ w_{n+70} = 8w_n - 7w_{n-10} \]
      
  \end{solution}

  \problempart Suppose you play the same poker game, but you have to
  pay the dealer a ``rake'' of \$5 every time you win a hand.

    \begin{solution}
      All that happens is that you win \$65 instead of \$70.
      \[ w_{n+65} = 8w_n - 7w_{n-10} \]
    \end{solution}

    \problempart What if there's no rake, but the dealer charges \$1 for
    every hand regardless of whether you win or lose? (At casinos, this
    is called ``paying time.'' It's not actually every hand, but it's
    also usually more than \$1.)

\begin{solution}
  \[
  w_{n+69} = 8w_n - 7w_{n-11}
  \]
\end{solution}

\end{editingnotes}

\problempart Let $e_n$ be the expected number of bets until the game
ends.  Write a linear recurrence with boundary conditions for
$e_n$.   You need \emph{not} solve the recurrence.

\begin{solution}
By the Law of Total Expectation, Theorem~\bref{total_expect},
\begin{align*}
  e_n &= \paren{1+\expcond{\text{\#bets with $\$n$ start}}{\text{won 1st bet}}}
       \cdot \pr{\text{won 1st bet}}\\
      & \quad + \paren{1+\expcond{\text{\#bets with $\$n$\ start}}{\text{lost 1st bet}}}
        \cdot \pr{\text{lost 1st  bet}}\\
      & = \paren{1+\expect{\text{\#bets with $\$(n+2)$ start}}}
        \cdot \pr{\text{won 1st bet}}\\
      & \quad + \paren{1+\expect{\text{number of bets starting with $\$(n-1)$}}}
        \cdot \pr{\text{lost 1st bet}},
\end{align*}
so
\[
e_n = \paren{e_{n+2} +1}\frac{12}{38} +
\paren{1+e_{n-1}}\frac{26}{38}
\]
Letting $m \eqdef n+2$ we get
\[
e_m = \frac{38}{12}e_{m-2} - \frac{26}{12} e_{m-3} - \frac{38}{12}
\]

As boundary conditions, we have
\[
e_0 = e_T = e_{T+1} = 0.
\]
Again, for this degree 3 recurrence three boundary values
    are necessary to determine the $e_n$ uniquely.
\end{solution}

  \end{problemparts}

\end{problem}

\endinput
