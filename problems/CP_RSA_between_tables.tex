\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_RSA_between_tables}
  \pcomment{from: S09.cp8r, S06.cp7w}
\end{pcomments}

\pkeywords{
  number_theory
  modular_arithmetic
  primes
  RSA
  Pulverizer
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}

Let's try out RSA!  \inhandout{There is a complete description of the
  algorithm in the text box.  You'll probably need extra paper.
  \textbf{Check your work carefully!}}

\bparts

\ppart Go through the \textbf{beforehand} steps.

\begin{itemize}

\item Choose primes $p$ and $q$ to be relatively small, say in the
range 10--40.  In practice, $p$ and $q$ might contain hundreds of
digits, but small numbers are easier to handle with pencil and paper.

\item Try $e = 3, 5, 7, \dots$ until you find something that works.
Use Euclid's algorithm to compute the gcd.

\item Find $d$ (using the Pulverizer).

\end{itemize}

When you're done, put your public key on the board prominentally
labelled ``Public Key.''  This lets another team send you a message.

\ppart Now send an encrypted message to another team using their
public key.  Select your message $m$ from the codebook below:

\begin{itemize}

\item 2 = Greetings and salutations!

\item 3 = Yo, wassup?

\item 4 = You guys are slow!

\item 5 = All your base are belong to us.

\item 6 = Someone on \emph{our} team thinks someone on \emph{your} team
is kinda cute.

\item 7 = You \emph{are} the weakest link.  Goodbye.

\end{itemize}

\ppart Decrypt the message sent to you and verify that you received
what the other team sent!

\eparts

\begin{staffnotes}
Aim to get each team to send at least two message and to decode at
least one received message.
\end{staffnotes}

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput

\iffalse

%%better to include in source document, eg, cp6w.tex

\inhandout{
\newpage
\subsection*{The RSA Cryptosystem}
A \textbf{Receiver} who wants to be able to receive secret numerical
messages creates a \emph{private key}, which they keep secret, and a
\emph{public key} which they make publicly available.  Anyone with the
public key can then be a \textbf{Sender} who can publicly send secret
messages to the \textbf{Receiver}---even if they have never
communicated or shared any information besides the public key.

Here is how they do it:

\begin{description}

\item[Beforehand] The \textbf{Receiver} creates a public key and a private key
as follows.

\begin{enumerate}

\item Generate two distinct primes, $p$ and $q$.  These are used to
  generate the private key, and they must be kept hidden.  (In current
  practice, $p$ and $q$ are chosen to be hundreds of digits long.)

\item Let $n \eqdef pq$.

\item Select an integer $e \in \Zintvco{1}{n}$ such that $\gcd(e, (p-1)(q-1)) = 1$.\\ The
\emph{public key} is the pair $(e, n)$.  This should be distributed
widely.

\item Compute $d \in \Zintvco{1}{n}$ such that $de \equiv 1 \pmod{(p-1)(q-1)}$.
  This can be done using the Pulverizer.\\ The \emph{private key} is
  the pair $(d, n)$.  This should be kept hidden!

\end{enumerate}

\item[Encoding]

To transmit a message $m \in \Zintvco{0}{n}$ to \textbf{Receiver}, a
\textbf{Sender} uses the public key to encrypt $m$ into a numerical
message
\[
\widehat{m} \eqdef \rem{m^e}{n}.
\]
The \textbf{Sender} can then publicly transmit $\widehat{m}$ to the
\textbf{Receiver}.

\item[Decoding] The \textbf{Receiver} decrypts message $\widehat{m}$ back to
  message $m$ using the private key:
\[
m = \rem{\widehat{m}^d}{n}.
\]

\end{description}
%\end{minipage}
}
\fi

\iffalse
Given a message~$m$, the sender first checks that $\gcd(m, n) =
1$.

\footnote{It would be very bad if $\gcd(m, n)$ equals $p$ or $q$
since then it would be easy for someone to use the encoded message to
compute the private key  If $\gcd(m, n) = n$, then the encoded message
would be~0, which is fairly useless.  For very large values of~$n$, it
is extremely unlikely that $\gcd(m, n) \ne 1$.  If this does happen,
you should get a new set of keys or, at the very least, add some bits
to~$m$ so that the resulting message is relatively prime to~$n$.}
\fi
