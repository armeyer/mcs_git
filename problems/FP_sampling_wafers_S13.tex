\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_sampling_wafers_S13}
  \pcomment{simplification of FP_sampling_wafers}
  \pcomment{similar to TP_sampling_perturbed}
  \pcomment{S17.final}
\end{pcomments}

\pkeywords{
  binomial
  sampling
  probability
  confidence
  asympttoic
  little_oh
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}

\begin{staffnotes}
\textbf{S17 final 6pts}
\end{staffnotes}


On May 23, 2017, the MIT fabrication facility produced a large batch
of silicon wafers.  To estimate the fraction $d$ of defective wafers
in this batch, we will randomly and independently choose a small
sample of $n_0$ wafers from the batch.  Then we will test the wafers
in the sample for defects, and will estimate that $d$ is approximately
the same as the fraction of defective wafers in the sample.

We want to calculate a small $n_0$ such that the fraction of defective
wafers in the sample will be within 0.006 of the actual fraction $d$
with 97\% confidence.  The following theorem about the binomial random
variable $B_{n,p}$ provides a good way to calculate $n_0$:

%\begin{equation}\label{eps}

\begin{theorem*} [Binomial Deviation]
\[
\Prob{\abs{\frac{B_{n,p}}{n} - p} \geq \epsilon}\leq f(\epsilon, n)
\]
where
\[
f(\epsilon, n) = o\paren{\frac{1}{\epsilon 2^{\epsilon n}}}.
\]
\end{theorem*}

\inbook{\begin{problemparts}

\problempart \label{sample-thm}} Suppose you have a program for
evaluating the function $f$.  Briefly explain how to use the Binomial
Deviation Theorem to find $n_0$, explicitly indicating which values
should be plugged into what formulas.

\begin{solution}
To find $n_0$, let $\epsilon = 0.006$, and search for the smallest $n_0$
such that $f(\epsilon,n_0)\leq 0.03$.  Such an $n_0$ will exist because
\[
\lim_{n \to \infty} f(\epsilon,n) \leq \lim_{n \to \infty} \frac{1}{\epsilon 2^{\epsilon n}} = 0 < 0.03\, .
\]
\end{solution}

\inbook{\eparts

\examspace[2in]

The calculations in part~\eqref{sample-thm} depend on some facts about
the batch and how the $n_0$ wafers in the sample are chosen.
Mathematically, the fabrication \emph{batch} is an actual outcome that
happened a week ago.  The \emph{sample} is a random variable defined
by the process for randomly choosing $n_0$ wafers from the batch.

For each statement below, indicate whether it is \True\ or \False.

\bparts

\ppart
  The probability that the ninth wafer in the \emph{sample} is
  defective is $d$.\hfill\brule{0.5in}

\begin{solution}
\textbf{True}.

    The ninth wafer in the sample is equally likely to be any wafer in
    the run, so the probability it is defective is the same as the
    fraction $d$ of defective wafers in the fabrication run.
\end{solution}

\ppart The probability that the ninth wafer in the \emph{batch} is
defective is $d$.\hfill\brule{0.5in}

\begin{solution}
\textbf{False}

    The fabrication run was completed last week, so there's nothing
    probabilistic about the defectiveness of the ninth (or any other)
    wafer in the run: either it is or it isn't defective, though we
    don't know which.  You could argue that this means it is defective
    with probability zero or one, but in any case, it certainly isn't
    $d$.
\end{solution}

\ppart
  All wafers are equally as likely to be selected as the third wafer in
  the \emph{sample}.\hfill\brule{0.5in}

\begin{solution}
\textbf{True.}

    The meaning of ``random choices of wafers from the run'' is
    precisely that at each of the $n$ choices in the sample, in
    particular at the third choice, each wafer in the run is equally
    likely to be chosen.
\end{solution}

\ppart The expectation of the indicator variable for the last wafer in
the \emph{sample} being \text{defective} is~$d$.\hfill\brule{0.5in}

\begin{solution}
\textbf{True.}

  The expectation of the indicator variable is the same as the
  probability that it is 1, namely, it is the probability that the
  $n$th wafer chosen is defective, which, by the reasoning we used
  in the first part of this question, is $d$.
\end{solution}

\ppart Given that the first wafer in the \emph{sample} is defective,
the probability that the second wafer will also be defective is
greater than than~$d$.\hfill\brule{0.5in}

\begin{solution}
\textbf{False}

  The meaning of ``\emph{independent} random choices of wafers
  from the run'' is precisely that at each of the $n$ choices in the
  sample, in particular at the second choice, each wafer in the run
  is equally likely to be chosen, independent of what the first or
  any other choice happened to be.
\end{solution}

\ppart Given that the last wafer in the \emph{batch} is defective, the
probability that the next-to-last wafer in the batch will also be
defective is greater than than~$d$.\hfill\brule{0.5in}

\begin{solution}
\textbf{False}

As noted above, it's zero or one.
\end{solution}

\ppart
    It turns out that there are several different possible wafer
    colors. Given that the first two wafers in the \emph{sample} are
    the same color, the probability that the first wafer is defective
    may be greater than $d$.\hfill\brule{0.5in}

\begin{solution}
  \textbf{True}, the conditional probability may be greater than $d$.

  We don't know how color correlates to defectiveness.  It could be
  for example, that most wafers in the run are white, and most white
  wafers are defective.  Then given that two randomly chosen wafers
  in the sample are the same color, their most likely color is white.
  This makes them more likely to be defective than usual, that is,
  the conditional probability that they will be defective would be
  greater than $d$.
\end{solution}

\ppart The probability that the same wafer will be chosen more than
once in the \emph{sample} is nonzero.\hfill\brule{0.5in}

\begin{solution}
\textbf{True}

  We know the length $r$ of the fabrication run is larger than the
  sample size $n$ in which case the probability that all the wafers
  in the sample are different is
  \[
  \frac{r}{r}\cdot \frac{r-1}{r}\cdot \frac{r-2}{r} \cdots 
\frac{r-(n-1)}{r}
  = \frac{r!}{(r-n)!r^n} > 0.
  \]
\end{solution}

\end{problemparts}
}

\end{problem}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
